<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 15 Decision Trees using R | R for Data Analytics</title>
  <meta name="description" content="This is a collection of examples on using R for Data Analytics" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 15 Decision Trees using R | R for Data Analytics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a collection of examples on using R for Data Analytics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 15 Decision Trees using R | R for Data Analytics" />
  
  <meta name="twitter:description" content="This is a collection of examples on using R for Data Analytics" />
  

<meta name="author" content="Abhay Singh" />


<meta name="date" content="2022-11-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="rforda.png" type="image/x-icon" />
<link rel="prev" href="04-Part_3_logistic.html"/>
<link rel="next" href="05-method2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i>Part I</a></li>
<li class="chapter" data-level="1" data-path="01-intro.html"><a href="01-intro.html#what-is-r"><i class="fa fa-check"></i><b>1</b> What is R?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-intro.html"><a href="01-intro.html#why-should-we-learn-r"><i class="fa fa-check"></i><b>1.1</b> Why should we learn R?</a></li>
<li class="chapter" data-level="1.2" data-path="01-intro.html"><a href="01-intro.html#Rinstall"><i class="fa fa-check"></i><b>1.2</b> Installing R and RStudio on Windows</a></li>
<li class="chapter" data-level="1.3" data-path="01-intro.html"><a href="01-intro.html#rstudio-guiide"><i class="fa fa-check"></i><b>1.3</b> RStudio GUI/IDE</a></li>
<li class="chapter" data-level="1.4" data-path="01-intro.html"><a href="01-intro.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing Packages</a></li>
<li class="chapter" data-level="1.5" data-path="01-intro.html"><a href="01-intro.html#getting-help"><i class="fa fa-check"></i><b>1.5</b> Getting Help</a></li>
<li class="chapter" data-level="1.6" data-path="01-intro.html"><a href="01-intro.html#task-views-in-r-introduction-installation"><i class="fa fa-check"></i><b>1.6</b> Task Views in R-Introduction &amp; Installation</a></li>
<li class="chapter" data-level="1.7" data-path="01-intro.html"><a href="01-intro.html#r-core-packages"><i class="fa fa-check"></i><b>1.7</b> R core packages</a></li>
<li class="chapter" data-level="1.8" data-path="01-intro.html"><a href="01-intro.html#example-1-hello-r"><i class="fa fa-check"></i><b>1.8</b> Example-1 Hello R!</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-data.html"><a href="02-data.html"><i class="fa fa-check"></i><b>2</b> R Data Types and Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-data.html"><a href="02-data.html#data-types"><i class="fa fa-check"></i><b>2.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="02-data.html"><a href="02-data.html#double"><i class="fa fa-check"></i><b>2.1.1</b> Double</a></li>
<li class="chapter" data-level="2.1.2" data-path="02-data.html"><a href="02-data.html#integer"><i class="fa fa-check"></i><b>2.1.2</b> Integer</a></li>
<li class="chapter" data-level="2.1.3" data-path="02-data.html"><a href="02-data.html#logical"><i class="fa fa-check"></i><b>2.1.3</b> Logical</a></li>
<li class="chapter" data-level="2.1.4" data-path="02-data.html"><a href="02-data.html#character"><i class="fa fa-check"></i><b>2.1.4</b> Character</a></li>
<li class="chapter" data-level="2.1.5" data-path="02-data.html"><a href="02-data.html#factor"><i class="fa fa-check"></i><b>2.1.5</b> Factor</a></li>
<li class="chapter" data-level="2.1.6" data-path="02-data.html"><a href="02-data.html#date-time"><i class="fa fa-check"></i><b>2.1.6</b> Date &amp; Time</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02-data.html"><a href="02-data.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.2</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="02-data.html"><a href="02-data.html#vector"><i class="fa fa-check"></i><b>2.2.1</b> Vector</a></li>
<li class="chapter" data-level="2.2.2" data-path="02-data.html"><a href="02-data.html#matrices"><i class="fa fa-check"></i><b>2.2.2</b> Matrices</a></li>
<li class="chapter" data-level="2.2.3" data-path="02-data.html"><a href="02-data.html#arrays"><i class="fa fa-check"></i><b>2.2.3</b> Arrays</a></li>
<li class="chapter" data-level="2.2.4" data-path="02-data.html"><a href="02-data.html#data-frames"><i class="fa fa-check"></i><b>2.2.4</b> Data Frames</a></li>
<li class="chapter" data-level="2.2.5" data-path="02-data.html"><a href="02-data.html#lists"><i class="fa fa-check"></i><b>2.2.5</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="02-data.html"><a href="02-data.html#data-importexport-in-r"><i class="fa fa-check"></i><b>2.3</b> Data Import/Export in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="02-data.html"><a href="02-data.html#reading-data-from-a-text-file"><i class="fa fa-check"></i><b>2.3.1</b> Reading Data from a Text File</a></li>
<li class="chapter" data-level="2.3.2" data-path="02-data.html"><a href="02-data.html#reading-data-from-csv-files"><i class="fa fa-check"></i><b>2.3.2</b> Reading Data from CSV files</a></li>
<li class="chapter" data-level="2.3.3" data-path="02-data.html"><a href="02-data.html#reading-from-excel-files"><i class="fa fa-check"></i><b>2.3.3</b> Reading from Excel Files</a></li>
<li class="chapter" data-level="2.3.4" data-path="02-data.html"><a href="02-data.html#reading-from-data-files-from-other-statistical-systems"><i class="fa fa-check"></i><b>2.3.4</b> Reading from Data Files from other Statistical Systems</a></li>
<li class="chapter" data-level="2.3.5" data-path="02-data.html"><a href="02-data.html#importing-data-using-rstudio"><i class="fa fa-check"></i><b>2.3.5</b> Importing Data using RStudio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html"><i class="fa fa-check"></i><b>3</b> R Programming - Short Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#programming-control-flow"><i class="fa fa-check"></i><b>3.1</b> Programming Control Flow</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#if-else-conditional-statements"><i class="fa fa-check"></i><b>3.1.1</b> if-else Conditional Statements</a></li>
<li class="chapter" data-level="3.1.2" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#loops"><i class="fa fa-check"></i><b>3.1.2</b> Loops</a></li>
<li class="chapter" data-level="3.1.3" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#mathttwhile-loop"><i class="fa fa-check"></i><b>3.1.3</b> <span class="math inline">\(\mathtt{while}\)</span> loop</a></li>
<li class="chapter" data-level="3.1.4" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#mathttrepeat-loop"><i class="fa fa-check"></i><b>3.1.4</b> <span class="math inline">\(\mathtt{repeat}\)</span> loop</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#functions-in-r"><i class="fa fa-check"></i><b>3.2</b> Functions in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html"><i class="fa fa-check"></i><b>4</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#data-preprocessing"><i class="fa fa-check"></i><b>4.1</b> Data Preprocessing</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#extracting-data"><i class="fa fa-check"></i><b>4.1.1</b> Extracting Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#combining-data-frames"><i class="fa fa-check"></i><b>4.1.2</b> Combining Data Frames</a></li>
<li class="chapter" data-level="4.1.3" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#sub-setting-and-logical-data-selection"><i class="fa fa-check"></i><b>4.1.3</b> Sub setting and Logical Data Selection</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#data-transformation-from-wide-to-long-or-vice-versa"><i class="fa fa-check"></i><b>4.2</b> Data Transformation from Wide to Long (or vice versa)</a></li>
<li class="chapter" data-level="4.3" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#summary-statistics"><i class="fa fa-check"></i><b>4.3</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#example-descriptive-statistics-of-stock-returns"><i class="fa fa-check"></i><b>4.3.1</b> Example-Descriptive Statistics of Stock Returns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-plots.html"><a href="05-plots.html"><i class="fa fa-check"></i><b>5</b> Graphics in R (Part-I)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-plots.html"><a href="05-plots.html#basic-plots-in-r"><i class="fa fa-check"></i><b>5.1</b> Basic Plots in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="05-plots.html"><a href="05-plots.html#scatter-plot"><i class="fa fa-check"></i><b>5.1.1</b> Scatter Plot</a></li>
<li class="chapter" data-level="5.1.2" data-path="05-plots.html"><a href="05-plots.html#line-plot"><i class="fa fa-check"></i><b>5.1.2</b> Line Plot</a></li>
<li class="chapter" data-level="5.1.3" data-path="05-plots.html"><a href="05-plots.html#bar-plot"><i class="fa fa-check"></i><b>5.1.3</b> Bar Plot</a></li>
<li class="chapter" data-level="5.1.4" data-path="05-plots.html"><a href="05-plots.html#pie-chart"><i class="fa fa-check"></i><b>5.1.4</b> Pie Chart</a></li>
<li class="chapter" data-level="5.1.5" data-path="05-plots.html"><a href="05-plots.html#scatter-plot-1"><i class="fa fa-check"></i><b>5.1.5</b> Scatter Plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="05-plots.html"><a href="05-plots.html#r-graphical-parameters"><i class="fa fa-check"></i><b>5.2</b> R Graphical Parameters</a></li>
<li class="chapter" data-level="5.3" data-path="05-plots.html"><a href="05-plots.html#introduction-to-ggplot2"><i class="fa fa-check"></i><b>5.3</b> Introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="05-plots.html"><a href="05-plots.html#mathttqplot"><i class="fa fa-check"></i><b>5.3.1</b> <span class="math inline">\(\mathtt{qplot}\)</span></a></li>
<li class="chapter" data-level="5.3.2" data-path="05-plots.html"><a href="05-plots.html#layered-graphics-using-mathttggplot"><i class="fa fa-check"></i><b>5.3.2</b> Layered graphics using <span class="math inline">\(\mathtt{ggplot}\)</span></a></li>
<li class="chapter" data-level="5.3.3" data-path="05-plots.html"><a href="05-plots.html#arranging-plots-using-gridextra"><i class="fa fa-check"></i><b>5.3.3</b> Arranging plots using gridExtra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html"><i class="fa fa-check"></i><b>6</b> Graphics in R (Part-II)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html#interactive-plots-using-plotly"><i class="fa fa-check"></i><b>6.1</b> Interactive Plots using Plotly</a></li>
<li class="chapter" data-level="6.2" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html#animation-using-gganimate"><i class="fa fa-check"></i><b>6.2</b> Animation using gganimate</a></li>
<li class="chapter" data-level="6.3" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html#plot-maps"><i class="fa fa-check"></i><b>6.3</b> Plot Maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="062-regression_1.html"><a href="062-regression_1.html"><i class="fa fa-check"></i>Part II</a></li>
<li class="chapter" data-level="7" data-path="062-regression_1.html"><a href="062-regression_1.html#linear-regression"><i class="fa fa-check"></i><b>7</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="062-regression_1.html"><a href="062-regression_1.html#investment-beta-using-r-single-index-model"><i class="fa fa-check"></i><b>7.1</b> Investment <span class="math inline">\(\beta\)</span> using R (Single Index Model)</a></li>
<li class="chapter" data-level="7.2" data-path="062-regression_1.html"><a href="062-regression_1.html#data-preprocessing-1"><i class="fa fa-check"></i><b>7.2</b> Data preprocessing</a></li>
<li class="chapter" data-level="7.3" data-path="062-regression_1.html"><a href="062-regression_1.html#visualisation"><i class="fa fa-check"></i><b>7.3</b> Visualisation</a></li>
<li class="chapter" data-level="7.4" data-path="062-regression_1.html"><a href="062-regression_1.html#regression-analysis-using-lm"><i class="fa fa-check"></i><b>7.4</b> Regression analysis using lm</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="062-regression_1.html"><a href="062-regression_1.html#multiple-regression"><i class="fa fa-check"></i><b>8</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="062-regression_1.html"><a href="062-regression_1.html#fama-french-three-factor-model"><i class="fa fa-check"></i><b>8.1</b> Fama-French Three Factor Model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="062-regression_1.html"><a href="062-regression_1.html#data-preprocessing-2"><i class="fa fa-check"></i><b>8.1.1</b> Data Preprocessing</a></li>
<li class="chapter" data-level="8.1.2" data-path="062-regression_1.html"><a href="062-regression_1.html#regression-analysis"><i class="fa fa-check"></i><b>8.1.2</b> Regression Analysis</a></li>
<li class="chapter" data-level="8.1.3" data-path="062-regression_1.html"><a href="062-regression_1.html#visualisation-1"><i class="fa fa-check"></i><b>8.1.3</b> Visualisation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="062-regression_1.html"><a href="062-regression_1.html#panel-regression"><i class="fa fa-check"></i><b>9</b> Panel Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="062-regression_1.html"><a href="062-regression_1.html#fixed-and-random-effects-using-the-plm-package"><i class="fa fa-check"></i><b>9.1</b> Fixed and Random effects using the <code>plm</code> package</a></li>
<li class="chapter" data-level="9.2" data-path="062-regression_1.html"><a href="062-regression_1.html#fixed-effects-model"><i class="fa fa-check"></i><b>9.2</b> Fixed Effects Model</a></li>
<li class="chapter" data-level="9.3" data-path="062-regression_1.html"><a href="062-regression_1.html#random-effects-model"><i class="fa fa-check"></i><b>9.3</b> Random Effects Model</a></li>
<li class="chapter" data-level="9.4" data-path="062-regression_1.html"><a href="062-regression_1.html#testing"><i class="fa fa-check"></i><b>9.4</b> Testing</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="062-regression_1.html"><a href="062-regression_1.html#panel-or-ols"><i class="fa fa-check"></i><b>9.4.1</b> Panel or OLS</a></li>
<li class="chapter" data-level="9.4.2" data-path="062-regression_1.html"><a href="062-regression_1.html#fixed-effect-or-random-effect"><i class="fa fa-check"></i><b>9.4.2</b> Fixed Effect or Random Effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="01-Part_1.html"><a href="01-Part_1.html"><i class="fa fa-check"></i><b>10</b> Technical Analysis using R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="01-Part_1.html"><a href="01-Part_1.html#technical-analysis-ta-using-r"><i class="fa fa-check"></i><b>10.1</b> Technical Analysis (TA) using R</a></li>
<li class="chapter" data-level="10.2" data-path="01-Part_1.html"><a href="01-Part_1.html#technical-charts"><i class="fa fa-check"></i><b>10.2</b> Technical Charts</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="01-Part_1.html"><a href="01-Part_1.html#candlesticks-and-ohlc-chart"><i class="fa fa-check"></i><b>10.2.1</b> Candlesticks and OHLC chart</a></li>
<li class="chapter" data-level="10.2.2" data-path="01-Part_1.html"><a href="01-Part_1.html#line-chart"><i class="fa fa-check"></i><b>10.2.2</b> Line chart</a></li>
<li class="chapter" data-level="10.2.3" data-path="01-Part_1.html"><a href="01-Part_1.html#candlestick-chart"><i class="fa fa-check"></i><b>10.2.3</b> Candlestick chart</a></li>
<li class="chapter" data-level="10.2.4" data-path="01-Part_1.html"><a href="01-Part_1.html#add-technical-indicators"><i class="fa fa-check"></i><b>10.2.4</b> Add technical indicators</a></li>
<li class="chapter" data-level="10.2.5" data-path="01-Part_1.html"><a href="01-Part_1.html#adding-indicators-sequentially"><i class="fa fa-check"></i><b>10.2.5</b> Adding indicators sequentially</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="01-Part_1.html"><a href="01-Part_1.html#forecasting-var-using-garch-models"><i class="fa fa-check"></i><b>11</b> Forecasting VaR using GARCH Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="01-Part_1.html"><a href="01-Part_1.html#value-at-risk"><i class="fa fa-check"></i><b>11.1</b> Value at Risk</a></li>
<li class="chapter" data-level="11.2" data-path="01-Part_1.html"><a href="01-Part_1.html#volatility-modelling-forecasting-using-garch"><i class="fa fa-check"></i><b>11.2</b> Volatility Modelling &amp; Forecasting using GARCH</a></li>
<li class="chapter" data-level="11.3" data-path="01-Part_1.html"><a href="01-Part_1.html#garch11-to-forecast-var"><i class="fa fa-check"></i><b>11.3</b> GARCH(1,1) to forecast VaR</a></li>
<li class="chapter" data-level="11.4" data-path="01-Part_1.html"><a href="01-Part_1.html#var-forecasts-using-out-of-sample"><i class="fa fa-check"></i><b>11.4</b> VaR forecasts using out of sample</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html"><i class="fa fa-check"></i><b>12</b> Portfolio Modelling using R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-analysis-quick-intro"><i class="fa fa-check"></i><b>12.1</b> Portfolio Analysis (Quick Intro)</a></li>
<li class="chapter" data-level="12.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#mean-variance-portfolio-important-concepts"><i class="fa fa-check"></i><b>12.2</b> Mean Variance Portfolio: Important concepts</a>
<ul>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#expected-return"><i class="fa fa-check"></i>Expected Return</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#risk"><i class="fa fa-check"></i>Risk</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#covariance-of-returns"><i class="fa fa-check"></i>Covariance of Returns</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#correlation"><i class="fa fa-check"></i>Correlation</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-return"><i class="fa fa-check"></i>Portfolio Return</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-risk"><i class="fa fa-check"></i>Portfolio Risk</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-risk-for-n-assets"><i class="fa fa-check"></i>Portfolio Risk for <em>N</em> Assets</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#diversification-markowitz-minimum-variance-portfolio"><i class="fa fa-check"></i><b>12.3</b> Diversification &amp; Markowitz Minimum Variance Portfolio</a></li>
<li class="chapter" data-level="12.4" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#minimum-variance-portfolio"><i class="fa fa-check"></i><b>12.4</b> Minimum Variance Portfolio</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#efficient-weights-for-two-assets"><i class="fa fa-check"></i><b>12.4.1</b> Efficient Weights for Two Assets</a></li>
<li class="chapter" data-level="12.4.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-with-n-risky-assets"><i class="fa fa-check"></i><b>12.4.2</b> Portfolio with N Risky Assets</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#using-r-to-construct-multi-asset-portfolio"><i class="fa fa-check"></i><b>12.5</b> Using R to Construct Multi-Asset Portfolio</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#data"><i class="fa fa-check"></i><b>12.5.1</b> Data</a></li>
<li class="chapter" data-level="12.5.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolios-with-random-weights"><i class="fa fa-check"></i><b>12.5.2</b> Portfolios with random weights</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#efficient-minimum-variance-portfolio-using-r-packages"><i class="fa fa-check"></i><b>12.6</b> Efficient (Minimum Variance) Portfolio using R packages</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#minimum-variance-and-portfolio-for-a-given-level-of-return"><i class="fa fa-check"></i><b>12.6.1</b> Minimum Variance and portfolio for a given level of return</a></li>
<li class="chapter" data-level="12.6.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-with-box-constraints"><i class="fa fa-check"></i><b>12.6.2</b> Portfolio with Box Constraints</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#evaluating-portfoios-risk-adjusted-performance"><i class="fa fa-check"></i><b>12.7</b> Evaluating Portfoios: Risk Adjusted Performance</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#sharpe-ratio"><i class="fa fa-check"></i><b>12.7.1</b> Sharpe Ratio</a></li>
<li class="chapter" data-level="12.7.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#roys-safety-ratio"><i class="fa fa-check"></i><b>12.7.2</b> Roy’s Safety Ratio</a></li>
<li class="chapter" data-level="12.7.3" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#treynors-ratio"><i class="fa fa-check"></i><b>12.7.3</b> Treynor’s Ratio</a></li>
<li class="chapter" data-level="12.7.4" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#sharpe-ratio-portfolio-in-r"><i class="fa fa-check"></i><b>12.7.4</b> Sharpe Ratio (Portfolio) in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html"><i class="fa fa-check"></i>Part III</a></li>
<li class="chapter" data-level="13" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#machine-learning-using-r-introduction-to-data-splitting-sampling-resampling"><i class="fa fa-check"></i><b>13</b> Machine Learning using R-Introduction to Data Splitting, Sampling &amp; Resampling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#machine-learning-process-quick-intro"><i class="fa fa-check"></i><b>13.1</b> Machine Learning Process (Quick Intro)</a></li>
<li class="chapter" data-level="13.2" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#data-splitting-sampling"><i class="fa fa-check"></i><b>13.2</b> Data Splitting: Sampling</a></li>
<li class="chapter" data-level="13.3" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#random-sampling"><i class="fa fa-check"></i><b>13.3</b> Random Sampling</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#base-r"><i class="fa fa-check"></i><b>13.3.1</b> Base R</a></li>
<li class="chapter" data-level="13.3.2" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#using-the-caret-package"><i class="fa fa-check"></i><b>13.3.2</b> Using the <code>caret</code> package</a></li>
<li class="chapter" data-level="13.3.3" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#using-the-rsample-package"><i class="fa fa-check"></i><b>13.3.3</b> Using the <code>rsample</code> package</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#stratified-sampling"><i class="fa fa-check"></i><b>13.4</b> Stratified Sampling</a></li>
<li class="chapter" data-level="13.5" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#resampling"><i class="fa fa-check"></i><b>13.5</b> Resampling</a></li>
<li class="chapter" data-level="13.6" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>13.6</b> K-fold Cross Validation</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#k-fold-cv-in-r"><i class="fa fa-check"></i>K-fold CV in R</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#cv-for-time-series-data"><i class="fa fa-check"></i><b>13.7</b> CV for time series data</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#cv-for-time-series-in-r"><i class="fa fa-check"></i>CV for time series in R</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#bootstrapping"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#bootsrapping-in-r"><i class="fa fa-check"></i>Bootsrapping in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html"><i class="fa fa-check"></i><b>14</b> Logistic Regression &amp; K-Nearest Neighbour (kNN) for Classification</a>
<ul>
<li class="chapter" data-level="14.1" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#logistic-regression"><i class="fa fa-check"></i><b>14.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="14.2" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#k-nearest-neighbour"><i class="fa fa-check"></i><b>14.2</b> K-Nearest Neighbour</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#nearest-neighbour-classification-quick-introduction"><i class="fa fa-check"></i>Nearest Neighbour classification (Quick Introduction)</a></li>
<li class="chapter" data-level="" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#k-nn-algorithm"><i class="fa fa-check"></i>k-NN Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#forecasting-stock-price-movement-using-ml"><i class="fa fa-check"></i><b>14.3</b> Forecasting Stock Price Movement using ML</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#data-indicators"><i class="fa fa-check"></i><b>14.3.1</b> Data &amp; Indicators</a></li>
<li class="chapter" data-level="14.3.2" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#visualise-the-data"><i class="fa fa-check"></i><b>14.3.2</b> Visualise the data</a></li>
<li class="chapter" data-level="14.3.3" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#using-logistic-regression"><i class="fa fa-check"></i><b>14.3.3</b> Using Logistic Regression</a></li>
<li class="chapter" data-level="14.3.4" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#using-k-nn"><i class="fa fa-check"></i><b>14.3.4</b> Using K-NN</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="04-Part_2.html"><a href="04-Part_2.html"><i class="fa fa-check"></i><b>15</b> Decision Trees using R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="04-Part_2.html"><a href="04-Part_2.html#import-data-and-pre-processing"><i class="fa fa-check"></i><b>15.1</b> Import Data and Pre-processing</a></li>
<li class="chapter" data-level="15.2" data-path="04-Part_2.html"><a href="04-Part_2.html#visualisation-some-features"><i class="fa fa-check"></i><b>15.2</b> Visualisation some features</a></li>
<li class="chapter" data-level="15.3" data-path="04-Part_2.html"><a href="04-Part_2.html#creating-training-and-testing-set-and-control"><i class="fa fa-check"></i><b>15.3</b> Creating Training and Testing Set and Control</a></li>
<li class="chapter" data-level="15.4" data-path="04-Part_2.html"><a href="04-Part_2.html#train-the-model-on-the-training-set"><i class="fa fa-check"></i><b>15.4</b> Train the model on the training set</a></li>
<li class="chapter" data-level="15.5" data-path="04-Part_2.html"><a href="04-Part_2.html#prediction-and-accuracy"><i class="fa fa-check"></i><b>15.5</b> Prediction and Accuracy</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="04-Part_2.html"><a href="04-Part_2.html#model-1"><i class="fa fa-check"></i><b>15.5.1</b> Model-1</a></li>
<li class="chapter" data-level="15.5.2" data-path="04-Part_2.html"><a href="04-Part_2.html#model-2"><i class="fa fa-check"></i><b>15.5.2</b> Model-2</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="04-Part_2.html"><a href="04-Part_2.html#feature-interpretation"><i class="fa fa-check"></i><b>15.6</b> Feature Interpretation</a></li>
<li class="chapter" data-level="15.7" data-path="04-Part_2.html"><a href="04-Part_2.html#tree-visualisation"><i class="fa fa-check"></i><b>15.7</b> Tree visualisation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="05-method2.html"><a href="05-method2.html"><i class="fa fa-check"></i><b>16</b> Text Mining using R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="05-method2.html"><a href="05-method2.html#introduction-to-text-mining"><i class="fa fa-check"></i><b>16.1</b> Introduction to Text Mining</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="05-method2.html"><a href="05-method2.html#text-data"><i class="fa fa-check"></i><b>16.1.1</b> Text Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="05-method2.html"><a href="05-method2.html#generic-text-mining-system"><i class="fa fa-check"></i><b>16.1.2</b> Generic Text Mining System</a></li>
<li class="chapter" data-level="16.1.3" data-path="05-method2.html"><a href="05-method2.html#data-pre-processing-in-text-mining"><i class="fa fa-check"></i><b>16.1.3</b> Data pre-processing in Text Mining</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="05-method2.html"><a href="05-method2.html#mining-twitter-text-data-using-r"><i class="fa fa-check"></i><b>16.2</b> Mining Twitter Text Data using R</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="05-method2.html"><a href="05-method2.html#obtaining-twitter-data"><i class="fa fa-check"></i><b>16.2.1</b> Obtaining Twitter Data</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="05-method2.html"><a href="05-method2.html#download-data"><i class="fa fa-check"></i><b>16.3</b> Download Data</a></li>
<li class="chapter" data-level="16.4" data-path="05-method2.html"><a href="05-method2.html#data-pre-processing"><i class="fa fa-check"></i><b>16.4</b> Data Pre-processing</a></li>
<li class="chapter" data-level="16.5" data-path="05-method2.html"><a href="05-method2.html#some-visualisation"><i class="fa fa-check"></i><b>16.5</b> Some Visualisation</a></li>
<li class="chapter" data-level="16.6" data-path="05-method2.html"><a href="05-method2.html#sentiment-analysis"><i class="fa fa-check"></i><b>16.6</b> Sentiment Analysis</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="05-method2.html"><a href="05-method2.html#method"><i class="fa fa-check"></i><b>16.6.1</b> Method</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="05-method2.html"><a href="05-method2.html#topic-modelling"><i class="fa fa-check"></i><b>16.7</b> Topic Modelling</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="06-summary.html"><a href="06-summary.html"><i class="fa fa-check"></i><b>17</b> Work in Progress</a></li>
<li class="chapter" data-level="" data-path="07-references.html"><a href="07-references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><img src="firebrick3RA_img.png" height="60" width="60" style="position:bottom:0px;right:0px;"/></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="decision-trees-using-r" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Topic 15</span> Decision Trees using R<a href="04-Part_2.html#decision-trees-using-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="rforda.png" height="100" width="100" style="position:absolute;top:0px;right:0px;" /></p>
<p>Some references: <span class="citation">Boehmke &amp; Greenwell (<a href="#ref-Boehmke2019" role="doc-biblioref">2019</a>)</span>, <span class="citation">Hastie et al. (<a href="#ref-Hastie2013" role="doc-biblioref">2013</a>)</span> and <span class="citation">Lantz (<a href="#ref-Lantz2019" role="doc-biblioref">2019</a>)</span></p>
<p>In this section we discuss tree based methods for classification.</p>
<ul>
<li><p>Tree-based models are a class of non-parametric algorithms that work by partitioning the feature space into a number of smaller (non-overlapping) regions with similar response values using a set of splitting rules.</p></li>
<li><p>These involve stratifying or segmenting the predictor space into a number of simple regions.</p></li>
<li><p>Typically use the mean or the mode of the training observations in the region to which it belongs.</p></li>
<li><p>Since the set of splitting rules used to segment the predictor space can be summarized in a tree, these types of approaches are known as decision tree methods.</p></li>
<li><p>Classification and Regression Tree (CART) (<span class="citation">Breiman, Friedman, Stone, &amp; Olshen (<a href="#ref-Breiman1984" role="doc-biblioref">1984</a>)</span>) is the most well-known decision tree algorithm.</p>
<ul>
<li>CART uses binary recursive partitioning: Each split depends on the split above (before) it.</li>
</ul></li>
<li><p>A basic decision tree partitions the training data into homogeneous subgroups (i.e., groups with similar response values) and then fits a simple constant in each subgroup (e.g., the mean of the within group response values for regression).</p></li>
<li><p>The subgroups (also called nodes) are formed recursively using binary partitions formed by asking simple yes-or-no questions about each feature.</p></li>
<li><p>This is done a number of times until a suitable stopping criteria is satisfied (e.g., a maximum depth of the tree is reached).</p></li>
<li><p>After all the partitioning has been done, the model predicts the output based on</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>the average response values for all observations that fall in that subgroup (regression problem), or</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>the class that has majority representation (classification problem)</li>
</ol></li>
</ul></li>
<li><p>Root node: First subgroup</p></li>
<li><p>Terminal node or Leaf node: Final subgroup</p></li>
<li><p>Internal node: Other subgroups between root and terminal node</p></li>
<li><p>Branches: Connection between the nodes</p></li>
</ul>
<p>We will apply the CART method on a Credit Risk Example</p>
<p>Two types of risks are associated with the bank’s decision</p>
<ul>
<li>If the applicant is a good credit risk, i.e. is likely to repay the loan, then not approving the loan to the person results in a loss of business to the bank</li>
<li>If the applicant is a bad credit risk, i.e. is not likely to repay the loan, then approving the loan to the person results in a financial loss to the bank</li>
</ul>
<blockquote>
<p>This analysis is an example and is not exhaustive list of methods available for data description, visualisation or ML using R.</p>
</blockquote>
<div id="import-data-and-pre-processing" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Import Data and Pre-processing<a href="04-Part_2.html#import-data-and-pre-processing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data discription is here <a href="https://onlinecourses.science.psu.edu/stat508/book/export/html/796" class="uri">https://onlinecourses.science.psu.edu/stat508/book/export/html/796</a></p>
<ul>
<li><p>20 variables</p>
<p>Status of existing checking account.
Duration in month
Credit history
Purpose
Credit amount
Savings account/bonds
Present employment since
Installment rate in percentage of disposable income
Personal status and sex
Other debtors / guarantors
Present residence since
Property
Age in years
Other installment plans
Housing
Number of existing credits at this bank
Job
Number of people being liable to provide maintenance for
Telephone
foreign worker</p></li>
</ul>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="04-Part_2.html#cb377-1" aria-hidden="true" tabindex="-1"></a>data_cr <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/german_credit.csv&quot;</span>)</span>
<span id="cb377-2"><a href="04-Part_2.html#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="co"># preliminary analysis descriptive and visual</span></span>
<span id="cb377-3"><a href="04-Part_2.html#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data_cr)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   1000 obs. of  21 variables:
 $ Creditability                    : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Account.Balance                  : int  1 1 2 1 1 1 1 1 4 2 ...
 $ Duration.of.Credit..month.       : int  18 9 12 12 12 10 8 6 18 24 ...
 $ Payment.Status.of.Previous.Credit: int  4 4 2 4 4 4 4 4 4 2 ...
 $ Purpose                          : int  2 0 9 0 0 0 0 0 3 3 ...
 $ Credit.Amount                    : int  1049 2799 841 2122 2171 2241 3398 1361 1098 3758 ...
 $ Value.Savings.Stocks             : int  1 1 2 1 1 1 1 1 1 3 ...
 $ Length.of.current.employment     : int  2 3 4 3 3 2 4 2 1 1 ...
 $ Instalment.per.cent              : int  4 2 2 3 4 1 1 2 4 1 ...
 $ Sex...Marital.Status             : int  2 3 2 3 3 3 3 3 2 2 ...
 $ Guarantors                       : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Duration.in.Current.address      : int  4 2 4 2 4 3 4 4 4 4 ...
 $ Most.valuable.available.asset    : int  2 1 1 1 2 1 1 1 3 4 ...
 $ Age..years.                      : int  21 36 23 39 38 48 39 40 65 23 ...
 $ Concurrent.Credits               : int  3 3 3 3 1 3 3 3 3 3 ...
 $ Type.of.apartment                : int  1 1 1 1 2 1 2 2 2 1 ...
 $ No.of.Credits.at.this.Bank       : int  1 2 1 2 2 2 2 1 2 1 ...
 $ Occupation                       : int  3 3 2 2 2 2 2 2 1 1 ...
 $ No.of.dependents                 : int  1 2 1 2 1 2 1 2 1 1 ...
 $ Telephone                        : int  1 1 1 1 1 1 1 1 1 1 ...
 $ Foreign.Worker                   : int  1 1 1 2 2 2 2 2 1 1 ...</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="04-Part_2.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NA</span></span>
<span id="cb379-2"><a href="04-Part_2.html#cb379-2" aria-hidden="true" tabindex="-1"></a>data_cr <span class="ot">=</span> <span class="fu">na.omit</span>(data_cr)</span>
<span id="cb379-3"><a href="04-Part_2.html#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="co"># quick summary</span></span>
<span id="cb379-4"><a href="04-Part_2.html#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_cr)</span></code></pre></div>
<pre><code> Creditability Account.Balance Duration.of.Credit..month.
 Min.   :0.0   Min.   :1.000   Min.   : 4.0              
 1st Qu.:0.0   1st Qu.:1.000   1st Qu.:12.0              
 Median :1.0   Median :2.000   Median :18.0              
 Mean   :0.7   Mean   :2.577   Mean   :20.9              
 3rd Qu.:1.0   3rd Qu.:4.000   3rd Qu.:24.0              
 Max.   :1.0   Max.   :4.000   Max.   :72.0              
 Payment.Status.of.Previous.Credit    Purpose       Credit.Amount  
 Min.   :0.000                     Min.   : 0.000   Min.   :  250  
 1st Qu.:2.000                     1st Qu.: 1.000   1st Qu.: 1366  
 Median :2.000                     Median : 2.000   Median : 2320  
 Mean   :2.545                     Mean   : 2.828   Mean   : 3271  
 3rd Qu.:4.000                     3rd Qu.: 3.000   3rd Qu.: 3972  
 Max.   :4.000                     Max.   :10.000   Max.   :18424  
 Value.Savings.Stocks Length.of.current.employment Instalment.per.cent
 Min.   :1.000        Min.   :1.000                Min.   :1.000      
 1st Qu.:1.000        1st Qu.:3.000                1st Qu.:2.000      
 Median :1.000        Median :3.000                Median :3.000      
 Mean   :2.105        Mean   :3.384                Mean   :2.973      
 3rd Qu.:3.000        3rd Qu.:5.000                3rd Qu.:4.000      
 Max.   :5.000        Max.   :5.000                Max.   :4.000      
 Sex...Marital.Status   Guarantors    Duration.in.Current.address
 Min.   :1.000        Min.   :1.000   Min.   :1.000              
 1st Qu.:2.000        1st Qu.:1.000   1st Qu.:2.000              
 Median :3.000        Median :1.000   Median :3.000              
 Mean   :2.682        Mean   :1.145   Mean   :2.845              
 3rd Qu.:3.000        3rd Qu.:1.000   3rd Qu.:4.000              
 Max.   :4.000        Max.   :3.000   Max.   :4.000              
 Most.valuable.available.asset  Age..years.    Concurrent.Credits
 Min.   :1.000                 Min.   :19.00   Min.   :1.000     
 1st Qu.:1.000                 1st Qu.:27.00   1st Qu.:3.000     
 Median :2.000                 Median :33.00   Median :3.000     
 Mean   :2.358                 Mean   :35.54   Mean   :2.675     
 3rd Qu.:3.000                 3rd Qu.:42.00   3rd Qu.:3.000     
 Max.   :4.000                 Max.   :75.00   Max.   :3.000     
 Type.of.apartment No.of.Credits.at.this.Bank   Occupation    No.of.dependents
 Min.   :1.000     Min.   :1.000              Min.   :1.000   Min.   :1.000   
 1st Qu.:2.000     1st Qu.:1.000              1st Qu.:3.000   1st Qu.:1.000   
 Median :2.000     Median :1.000              Median :3.000   Median :1.000   
 Mean   :1.928     Mean   :1.407              Mean   :2.904   Mean   :1.155   
 3rd Qu.:2.000     3rd Qu.:2.000              3rd Qu.:3.000   3rd Qu.:1.000   
 Max.   :3.000     Max.   :4.000              Max.   :4.000   Max.   :2.000   
   Telephone     Foreign.Worker 
 Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000  
 Median :1.000   Median :1.000  
 Mean   :1.404   Mean   :1.037  
 3rd Qu.:2.000   3rd Qu.:1.000  
 Max.   :2.000   Max.   :2.000  </code></pre>
<ul>
<li>Let’s convert data types to as all of them are factors but some of them should be used as numeric</li>
</ul>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="04-Part_2.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(data_cr, class)</span></code></pre></div>
<pre><code>                    Creditability                   Account.Balance 
                        &quot;integer&quot;                         &quot;integer&quot; 
       Duration.of.Credit..month. Payment.Status.of.Previous.Credit 
                        &quot;integer&quot;                         &quot;integer&quot; 
                          Purpose                     Credit.Amount 
                        &quot;integer&quot;                         &quot;integer&quot; 
             Value.Savings.Stocks      Length.of.current.employment 
                        &quot;integer&quot;                         &quot;integer&quot; 
              Instalment.per.cent              Sex...Marital.Status 
                        &quot;integer&quot;                         &quot;integer&quot; 
                       Guarantors       Duration.in.Current.address 
                        &quot;integer&quot;                         &quot;integer&quot; 
    Most.valuable.available.asset                       Age..years. 
                        &quot;integer&quot;                         &quot;integer&quot; 
               Concurrent.Credits                 Type.of.apartment 
                        &quot;integer&quot;                         &quot;integer&quot; 
       No.of.Credits.at.this.Bank                        Occupation 
                        &quot;integer&quot;                         &quot;integer&quot; 
                 No.of.dependents                         Telephone 
                        &quot;integer&quot;                         &quot;integer&quot; 
                   Foreign.Worker 
                        &quot;integer&quot; </code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="04-Part_2.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep Duration.of.Credit..month and Credit.Amount as numeric rest to</span></span>
<span id="cb383-2"><a href="04-Part_2.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="co"># factors</span></span>
<span id="cb383-3"><a href="04-Part_2.html#cb383-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">21</span>)</span>
<span id="cb383-4"><a href="04-Part_2.html#cb383-4" aria-hidden="true" tabindex="-1"></a>data_cr[id] <span class="ot">=</span> <span class="fu">lapply</span>(data_cr[id], as.factor)</span></code></pre></div>
<hr />
</div>
<div id="visualisation-some-features" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Visualisation some features<a href="04-Part_2.html#visualisation-some-features" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Create some visualisation to visualise data characteristics</p></li>
<li><p>Box plots <a href="04-Part_2.html#fig:boxplot">15.1</a> for Duration of Credit and Credit Amount</p></li>
</ul>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="04-Part_2.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb384-2"><a href="04-Part_2.html#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb384-3"><a href="04-Part_2.html#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co"># copy of data for plots</span></span>
<span id="cb384-4"><a href="04-Part_2.html#cb384-4" aria-hidden="true" tabindex="-1"></a>data_cr_p <span class="ot">=</span> data_cr</span>
<span id="cb384-5"><a href="04-Part_2.html#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set theme for the session</span></span>
<span id="cb384-6"><a href="04-Part_2.html#cb384-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb384-7"><a href="04-Part_2.html#cb384-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(data_cr, <span class="fu">aes</span>(Duration.of.Credit..month., <span class="at">fill =</span> Creditability)) <span class="sc">+</span></span>
<span id="cb384-8"><a href="04-Part_2.html#cb384-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span>
<span id="cb384-9"><a href="04-Part_2.html#cb384-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(data_cr_p, <span class="fu">aes</span>(Credit.Amount, Creditability, <span class="at">fill =</span> Creditability)) <span class="sc">+</span></span>
<span id="cb384-10"><a href="04-Part_2.html#cb384-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span>
<span id="cb384-11"><a href="04-Part_2.html#cb384-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-12"><a href="04-Part_2.html#cb384-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:boxplot"></span>
<img src="04-Part_2_files/figure-html/boxplot-1.png" alt="Box Plots" width="672" />
<p class="caption">
Figure 15.1: Box Plots
</p>
</div>
<ul>
<li>See the relationship between Purpose, Sex/status and Creditability <a href="04-Part_2.html#fig:barplot">15.2</a></li>
</ul>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="04-Part_2.html#cb385-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">=</span> <span class="fu">ggplot</span>(data_cr_p, <span class="fu">aes</span>(Purpose)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Creditability),</span>
<span id="cb385-2"><a href="04-Part_2.html#cb385-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span>
<span id="cb385-3"><a href="04-Part_2.html#cb385-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-4"><a href="04-Part_2.html#cb385-4" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">=</span> <span class="fu">ggplot</span>(data_cr_p, <span class="fu">aes</span>(Sex...Marital.Status)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Creditability),</span>
<span id="cb385-5"><a href="04-Part_2.html#cb385-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;count&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span>
<span id="cb385-6"><a href="04-Part_2.html#cb385-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-7"><a href="04-Part_2.html#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:barplot"></span>
<img src="04-Part_2_files/figure-html/barplot-1.png" alt="Bar plots" width="672" />
<p class="caption">
Figure 15.2: Bar plots
</p>
</div>
</div>
<div id="creating-training-and-testing-set-and-control" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Creating Training and Testing Set and Control<a href="04-Part_2.html#creating-training-and-testing-set-and-control" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Use rsample package and stratified sampling</li>
<li>Using mutliple cross validation for resampling</li>
</ul>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="04-Part_2.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rsample)</span>
<span id="cb386-2"><a href="04-Part_2.html#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb386-3"><a href="04-Part_2.html#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)  <span class="co">#for reproducibility (can pick your own seed, but keep it consistent)</span></span>
<span id="cb386-4"><a href="04-Part_2.html#cb386-4" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">=</span> <span class="fu">initial_split</span>(<span class="at">data =</span> data_cr, <span class="at">prop =</span> <span class="fl">0.8</span>, <span class="at">strata =</span> <span class="st">&quot;Creditability&quot;</span>)</span>
<span id="cb386-5"><a href="04-Part_2.html#cb386-5" aria-hidden="true" tabindex="-1"></a>d_train1 <span class="ot">=</span> <span class="fu">training</span>(idx)</span>
<span id="cb386-6"><a href="04-Part_2.html#cb386-6" aria-hidden="true" tabindex="-1"></a>d_test1 <span class="ot">=</span> <span class="fu">testing</span>(idx)</span>
<span id="cb386-7"><a href="04-Part_2.html#cb386-7" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(d_train1<span class="sc">$</span>Creditability))</span></code></pre></div>
<pre><code>
  0   1 
0.3 0.7 </code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="04-Part_2.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(d_test1<span class="sc">$</span>Creditability))</span></code></pre></div>
<pre><code>
  0   1 
0.3 0.7 </code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="04-Part_2.html#cb390-1" aria-hidden="true" tabindex="-1"></a>cntrl1 <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">2</span>)  <span class="co">#using repeated cross validate (repeating twice)</span></span></code></pre></div>
</div>
<div id="train-the-model-on-the-training-set" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Train the model on the training set<a href="04-Part_2.html#train-the-model-on-the-training-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Use rpart package and caret package</p></li>
<li><p>The following block may results in slightly different results on individual computers. The fitted models are in data folder</p></li>
</ul>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="04-Part_2.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)  <span class="co">#for reproducibility</span></span>
<span id="cb391-2"><a href="04-Part_2.html#cb391-2" aria-hidden="true" tabindex="-1"></a>cv_tree1 <span class="ot">=</span> <span class="fu">train</span>(Creditability <span class="sc">~</span> ., <span class="at">data =</span> d_train1, <span class="at">trControl =</span> cntrl1,</span>
<span id="cb391-3"><a href="04-Part_2.html#cb391-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, <span class="at">tuneLength =</span> <span class="dv">20</span>, <span class="at">parms =</span> <span class="fu">list</span>(<span class="at">split =</span> <span class="st">&quot;gini&quot;</span>))  <span class="co">#using gini index </span></span>
<span id="cb391-4"><a href="04-Part_2.html#cb391-4" aria-hidden="true" tabindex="-1"></a>cv_tree2 <span class="ot">=</span> <span class="fu">train</span>(Creditability <span class="sc">~</span> ., <span class="at">data =</span> d_train1, <span class="at">trControl =</span> cntrl1,</span>
<span id="cb391-5"><a href="04-Part_2.html#cb391-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, <span class="at">tuneLength =</span> <span class="dv">20</span>, <span class="at">parms =</span> <span class="fu">list</span>(<span class="at">split =</span> <span class="st">&quot;information&quot;</span>))  <span class="co">#using information </span></span></code></pre></div>
<ul>
<li><p>The fitted models were saved afterwards as <em>cv_tree1_gini.Rdata</em> and <em>cv_tree2_info.Rdata</em></p></li>
<li><p>Loading the fitted models to analyse</p></li>
</ul>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="04-Part_2.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb392-2"><a href="04-Part_2.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/cv_tree1_gini.Rdata&quot;</span>)</span>
<span id="cb392-3"><a href="04-Part_2.html#cb392-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;data/cv_tree2_info.Rdata&quot;</span>)</span>
<span id="cb392-4"><a href="04-Part_2.html#cb392-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model fit 1</span></span>
<span id="cb392-5"><a href="04-Part_2.html#cb392-5" aria-hidden="true" tabindex="-1"></a>cv_tree1</span></code></pre></div>
<pre><code>CART 

802 samples
 20 predictor
  2 classes: &#39;0&#39;, &#39;1&#39; 

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 2 times) 
Summary of sample sizes: 721, 722, 722, 722, 722, 721, ... 
Resampling results across tuning parameters:

  cp           Accuracy   Kappa    
  0.000000000  0.6969830  0.2512465
  0.001747106  0.6988580  0.2543412
  0.003494213  0.7063349  0.2628946
  0.005241319  0.7206867  0.2861502
  0.006988425  0.7200540  0.2777666
  0.008735532  0.7200617  0.2727974
  0.010482638  0.7244367  0.2758523
  0.012229744  0.7219444  0.2739317
  0.013976851  0.7256636  0.2964605
  0.015723957  0.7262886  0.2940382
  0.017471064  0.7262886  0.2936297
  0.019218170  0.7238272  0.2881274
  0.020965276  0.7225926  0.2839374
  0.022712383  0.7225926  0.2839374
  0.024459489  0.7151466  0.2534916
  0.026206595  0.7145370  0.2595461
  0.027953702  0.7070833  0.2284884
  0.029700808  0.7014583  0.2203101
  0.031447914  0.6983565  0.1916670
  0.033195021  0.6902701  0.1609005

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was cp = 0.01747106.</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="04-Part_2.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model fit 2</span></span>
<span id="cb394-2"><a href="04-Part_2.html#cb394-2" aria-hidden="true" tabindex="-1"></a>cv_tree2</span></code></pre></div>
<pre><code>CART 

802 samples
 20 predictor
  2 classes: &#39;0&#39;, &#39;1&#39; 

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 2 times) 
Summary of sample sizes: 721, 722, 722, 722, 721, 722, ... 
Resampling results across tuning parameters:

  cp           Accuracy   Kappa    
  0.000000000  0.6963735  0.2470114
  0.001747106  0.7056867  0.2628565
  0.003494213  0.7050849  0.2532738
  0.005241319  0.7056867  0.2530103
  0.006988425  0.7144290  0.2708436
  0.008735532  0.7144290  0.2715985
  0.010482638  0.7200540  0.2804530
  0.012229744  0.7237654  0.2784178
  0.013976851  0.7275154  0.2885322
  0.015723957  0.7231404  0.2833342
  0.017471064  0.7237731  0.2843818
  0.019218170  0.7243981  0.2782958
  0.020965276  0.7237886  0.2732868
  0.022712383  0.7237886  0.2732868
  0.024459489  0.7225386  0.2708625
  0.026206595  0.7144136  0.2456549
  0.027953702  0.7082022  0.2211492
  0.029700808  0.7082022  0.2211492
  0.031447914  0.7013580  0.1774435
  0.033195021  0.6976080  0.1496378

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was cp = 0.01397685.</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="04-Part_2.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv_tree1)  <span class="co">#parameter search using gini</span></span></code></pre></div>
<p><img src="04-Part_2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="04-Part_2.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv_tree2)  <span class="co">#parameter search using information</span></span></code></pre></div>
<p><img src="04-Part_2_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
</div>
<div id="prediction-and-accuracy" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> Prediction and Accuracy<a href="04-Part_2.html#prediction-and-accuracy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Using testing set and confusion matrix to compare accuracies</li>
</ul>
<div id="model-1" class="section level3 hasAnchor" number="15.5.1">
<h3><span class="header-section-number">15.5.1</span> Model-1<a href="04-Part_2.html#model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="04-Part_2.html#cb398-1" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">=</span> <span class="fu">predict</span>(cv_tree1, <span class="at">newdata =</span> d_test1)</span>
<span id="cb398-2"><a href="04-Part_2.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred1, d_test1<span class="sc">$</span>Creditability)</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0  33  10
         1  27 130
                                          
               Accuracy : 0.815           
                 95% CI : (0.7541, 0.8663)
    No Information Rate : 0.7             
    P-Value [Acc &gt; NIR] : 0.0001479       
                                          
                  Kappa : 0.5207          
                                          
 Mcnemar&#39;s Test P-Value : 0.0085289       
                                          
            Sensitivity : 0.5500          
            Specificity : 0.9286          
         Pos Pred Value : 0.7674          
         Neg Pred Value : 0.8280          
             Prevalence : 0.3000          
         Detection Rate : 0.1650          
   Detection Prevalence : 0.2150          
      Balanced Accuracy : 0.7393          
                                          
       &#39;Positive&#39; Class : 0               
                                          </code></pre>
</div>
<div id="model-2" class="section level3 hasAnchor" number="15.5.2">
<h3><span class="header-section-number">15.5.2</span> Model-2<a href="04-Part_2.html#model-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="04-Part_2.html#cb400-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">=</span> <span class="fu">predict</span>(cv_tree2, <span class="at">newdata =</span> d_test1)</span>
<span id="cb400-2"><a href="04-Part_2.html#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred2, d_test1<span class="sc">$</span>Creditability)</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0  32   9
         1  28 131
                                          
               Accuracy : 0.815           
                 95% CI : (0.7541, 0.8663)
    No Information Rate : 0.7             
    P-Value [Acc &gt; NIR] : 0.0001479       
                                          
                  Kappa : 0.5157          
                                          
 Mcnemar&#39;s Test P-Value : 0.0030846       
                                          
            Sensitivity : 0.5333          
            Specificity : 0.9357          
         Pos Pred Value : 0.7805          
         Neg Pred Value : 0.8239          
             Prevalence : 0.3000          
         Detection Rate : 0.1600          
   Detection Prevalence : 0.2050          
      Balanced Accuracy : 0.7345          
                                          
       &#39;Positive&#39; Class : 0               
                                          </code></pre>
</div>
</div>
<div id="feature-interpretation" class="section level2 hasAnchor" number="15.6">
<h2><span class="header-section-number">15.6</span> Feature Interpretation<a href="04-Part_2.html#feature-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>We can use the vip package to create a graph of feature importance</li>
</ul>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="04-Part_2.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb402-2"><a href="04-Part_2.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(cv_tree1, <span class="at">num_features =</span> <span class="dv">20</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:cart1"></span>
<img src="04-Part_2_files/figure-html/cart1-1.png" alt="Variable importance based on the total reduction in MSE " width="672" />
<p class="caption">
Figure 15.3: Variable importance based on the total reduction in MSE
</p>
</div>
</div>
<div id="tree-visualisation" class="section level2 hasAnchor" number="15.7">
<h2><span class="header-section-number">15.7</span> Tree visualisation<a href="04-Part_2.html#tree-visualisation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Let’s visualise tree using the first model</p></li>
<li><p>Use rpart.plot</p></li>
</ul>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="04-Part_2.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb403-2"><a href="04-Part_2.html#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(cv_tree1<span class="sc">$</span>finalModel, <span class="at">main =</span> <span class="st">&quot;Decision Tree using Gini Index&quot;</span>,</span>
<span id="cb403-3"><a href="04-Part_2.html#cb403-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">tweak =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:cart2"></span>
<img src="04-Part_2_files/figure-html/cart2-1.png" alt="Decision Tree using rpart.plot" width="1344" />
<p class="caption">
Figure 15.4: Decision Tree using rpart.plot
</p>
</div>

</div>
</div>
<h3>References<a href="07-references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Boehmke2019" class="csl-entry">
Boehmke, B., &amp; Greenwell, B. M. (2019). <em>Hands-on machine learning with r</em>. CRC Press. Retrieved from <a href="https://bradleyboehmke.github.io/HOML/">https://bradleyboehmke.github.io/HOML/</a>
</div>
<div id="ref-Breiman1984" class="csl-entry">
Breiman, L., Friedman, J., Stone, C. J., &amp; Olshen, R. A. (1984). <em>Classification and regression trees</em>. CRC press.
</div>
<div id="ref-Hastie2013" class="csl-entry">
Hastie, T., Tibshirani, R., James, G., &amp; Witten, D. (2013). <em>An introduction to statistical learning with applications in r</em>. Springer New York.
</div>
<div id="ref-Lantz2019" class="csl-entry">
Lantz, B. (2019). <em>Machine learning with r (3rd edition)</em>. Packt Publishing. Retrieved from <a href="https://app.knovel.com/hotlink/toc/id:kpMLRE000A/machine-learning-with/machine-learning-with">https://app.knovel.com/hotlink/toc/id:kpMLRE000A/machine-learning-with/machine-learning-with</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="04-Part_3_logistic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="05-method2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
