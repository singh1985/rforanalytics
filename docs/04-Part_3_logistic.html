<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 14 Logistic Regression &amp; K-Nearest Neighbour (kNN) for Classification | R for Data Analytics</title>
  <meta name="description" content="This is a collection of examples on using R for Data Analytics" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 14 Logistic Regression &amp; K-Nearest Neighbour (kNN) for Classification | R for Data Analytics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a collection of examples on using R for Data Analytics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 14 Logistic Regression &amp; K-Nearest Neighbour (kNN) for Classification | R for Data Analytics" />
  
  <meta name="twitter:description" content="This is a collection of examples on using R for Data Analytics" />
  

<meta name="author" content="Abhay Singh" />


<meta name="date" content="2022-11-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="rforda.png" type="image/x-icon" />
<link rel="prev" href="04-Part_3-1.html"/>
<link rel="next" href="04-Part_2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i>Part I</a></li>
<li class="chapter" data-level="1" data-path="01-intro.html"><a href="01-intro.html#what-is-r"><i class="fa fa-check"></i><b>1</b> What is R?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-intro.html"><a href="01-intro.html#why-should-we-learn-r"><i class="fa fa-check"></i><b>1.1</b> Why should we learn R?</a></li>
<li class="chapter" data-level="1.2" data-path="01-intro.html"><a href="01-intro.html#Rinstall"><i class="fa fa-check"></i><b>1.2</b> Installing R and RStudio on Windows</a></li>
<li class="chapter" data-level="1.3" data-path="01-intro.html"><a href="01-intro.html#rstudio-guiide"><i class="fa fa-check"></i><b>1.3</b> RStudio GUI/IDE</a></li>
<li class="chapter" data-level="1.4" data-path="01-intro.html"><a href="01-intro.html#installing-packages"><i class="fa fa-check"></i><b>1.4</b> Installing Packages</a></li>
<li class="chapter" data-level="1.5" data-path="01-intro.html"><a href="01-intro.html#getting-help"><i class="fa fa-check"></i><b>1.5</b> Getting Help</a></li>
<li class="chapter" data-level="1.6" data-path="01-intro.html"><a href="01-intro.html#task-views-in-r-introduction-installation"><i class="fa fa-check"></i><b>1.6</b> Task Views in R-Introduction &amp; Installation</a></li>
<li class="chapter" data-level="1.7" data-path="01-intro.html"><a href="01-intro.html#r-core-packages"><i class="fa fa-check"></i><b>1.7</b> R core packages</a></li>
<li class="chapter" data-level="1.8" data-path="01-intro.html"><a href="01-intro.html#example-1-hello-r"><i class="fa fa-check"></i><b>1.8</b> Example-1 Hello R!</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="02-data.html"><a href="02-data.html"><i class="fa fa-check"></i><b>2</b> R Data Types and Data Structures</a>
<ul>
<li class="chapter" data-level="2.1" data-path="02-data.html"><a href="02-data.html#data-types"><i class="fa fa-check"></i><b>2.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="02-data.html"><a href="02-data.html#double"><i class="fa fa-check"></i><b>2.1.1</b> Double</a></li>
<li class="chapter" data-level="2.1.2" data-path="02-data.html"><a href="02-data.html#integer"><i class="fa fa-check"></i><b>2.1.2</b> Integer</a></li>
<li class="chapter" data-level="2.1.3" data-path="02-data.html"><a href="02-data.html#logical"><i class="fa fa-check"></i><b>2.1.3</b> Logical</a></li>
<li class="chapter" data-level="2.1.4" data-path="02-data.html"><a href="02-data.html#character"><i class="fa fa-check"></i><b>2.1.4</b> Character</a></li>
<li class="chapter" data-level="2.1.5" data-path="02-data.html"><a href="02-data.html#factor"><i class="fa fa-check"></i><b>2.1.5</b> Factor</a></li>
<li class="chapter" data-level="2.1.6" data-path="02-data.html"><a href="02-data.html#date-time"><i class="fa fa-check"></i><b>2.1.6</b> Date &amp; Time</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="02-data.html"><a href="02-data.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.2</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="02-data.html"><a href="02-data.html#vector"><i class="fa fa-check"></i><b>2.2.1</b> Vector</a></li>
<li class="chapter" data-level="2.2.2" data-path="02-data.html"><a href="02-data.html#matrices"><i class="fa fa-check"></i><b>2.2.2</b> Matrices</a></li>
<li class="chapter" data-level="2.2.3" data-path="02-data.html"><a href="02-data.html#arrays"><i class="fa fa-check"></i><b>2.2.3</b> Arrays</a></li>
<li class="chapter" data-level="2.2.4" data-path="02-data.html"><a href="02-data.html#data-frames"><i class="fa fa-check"></i><b>2.2.4</b> Data Frames</a></li>
<li class="chapter" data-level="2.2.5" data-path="02-data.html"><a href="02-data.html#lists"><i class="fa fa-check"></i><b>2.2.5</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="02-data.html"><a href="02-data.html#data-importexport-in-r"><i class="fa fa-check"></i><b>2.3</b> Data Import/Export in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="02-data.html"><a href="02-data.html#reading-data-from-a-text-file"><i class="fa fa-check"></i><b>2.3.1</b> Reading Data from a Text File</a></li>
<li class="chapter" data-level="2.3.2" data-path="02-data.html"><a href="02-data.html#reading-data-from-csv-files"><i class="fa fa-check"></i><b>2.3.2</b> Reading Data from CSV files</a></li>
<li class="chapter" data-level="2.3.3" data-path="02-data.html"><a href="02-data.html#reading-from-excel-files"><i class="fa fa-check"></i><b>2.3.3</b> Reading from Excel Files</a></li>
<li class="chapter" data-level="2.3.4" data-path="02-data.html"><a href="02-data.html#reading-from-data-files-from-other-statistical-systems"><i class="fa fa-check"></i><b>2.3.4</b> Reading from Data Files from other Statistical Systems</a></li>
<li class="chapter" data-level="2.3.5" data-path="02-data.html"><a href="02-data.html#importing-data-using-rstudio"><i class="fa fa-check"></i><b>2.3.5</b> Importing Data using RStudio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html"><i class="fa fa-check"></i><b>3</b> R Programming - Short Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#programming-control-flow"><i class="fa fa-check"></i><b>3.1</b> Programming Control Flow</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#if-else-conditional-statements"><i class="fa fa-check"></i><b>3.1.1</b> if-else Conditional Statements</a></li>
<li class="chapter" data-level="3.1.2" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#loops"><i class="fa fa-check"></i><b>3.1.2</b> Loops</a></li>
<li class="chapter" data-level="3.1.3" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#mathttwhile-loop"><i class="fa fa-check"></i><b>3.1.3</b> <span class="math inline">\(\mathtt{while}\)</span> loop</a></li>
<li class="chapter" data-level="3.1.4" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#mathttrepeat-loop"><i class="fa fa-check"></i><b>3.1.4</b> <span class="math inline">\(\mathtt{repeat}\)</span> loop</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="03-programming_data_preprocessing.html"><a href="03-programming_data_preprocessing.html#functions-in-r"><i class="fa fa-check"></i><b>3.2</b> Functions in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html"><i class="fa fa-check"></i><b>4</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="4.1" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#data-preprocessing"><i class="fa fa-check"></i><b>4.1</b> Data Preprocessing</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#extracting-data"><i class="fa fa-check"></i><b>4.1.1</b> Extracting Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#combining-data-frames"><i class="fa fa-check"></i><b>4.1.2</b> Combining Data Frames</a></li>
<li class="chapter" data-level="4.1.3" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#sub-setting-and-logical-data-selection"><i class="fa fa-check"></i><b>4.1.3</b> Sub setting and Logical Data Selection</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#data-transformation-from-wide-to-long-or-vice-versa"><i class="fa fa-check"></i><b>4.2</b> Data Transformation from Wide to Long (or vice versa)</a></li>
<li class="chapter" data-level="4.3" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#summary-statistics"><i class="fa fa-check"></i><b>4.3</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="04-Data_Exploration.html"><a href="04-Data_Exploration.html#example-descriptive-statistics-of-stock-returns"><i class="fa fa-check"></i><b>4.3.1</b> Example-Descriptive Statistics of Stock Returns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="05-plots.html"><a href="05-plots.html"><i class="fa fa-check"></i><b>5</b> Graphics in R (Part-I)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="05-plots.html"><a href="05-plots.html#basic-plots-in-r"><i class="fa fa-check"></i><b>5.1</b> Basic Plots in R</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="05-plots.html"><a href="05-plots.html#scatter-plot"><i class="fa fa-check"></i><b>5.1.1</b> Scatter Plot</a></li>
<li class="chapter" data-level="5.1.2" data-path="05-plots.html"><a href="05-plots.html#line-plot"><i class="fa fa-check"></i><b>5.1.2</b> Line Plot</a></li>
<li class="chapter" data-level="5.1.3" data-path="05-plots.html"><a href="05-plots.html#bar-plot"><i class="fa fa-check"></i><b>5.1.3</b> Bar Plot</a></li>
<li class="chapter" data-level="5.1.4" data-path="05-plots.html"><a href="05-plots.html#pie-chart"><i class="fa fa-check"></i><b>5.1.4</b> Pie Chart</a></li>
<li class="chapter" data-level="5.1.5" data-path="05-plots.html"><a href="05-plots.html#scatter-plot-1"><i class="fa fa-check"></i><b>5.1.5</b> Scatter Plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="05-plots.html"><a href="05-plots.html#r-graphical-parameters"><i class="fa fa-check"></i><b>5.2</b> R Graphical Parameters</a></li>
<li class="chapter" data-level="5.3" data-path="05-plots.html"><a href="05-plots.html#introduction-to-ggplot2"><i class="fa fa-check"></i><b>5.3</b> Introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="05-plots.html"><a href="05-plots.html#mathttqplot"><i class="fa fa-check"></i><b>5.3.1</b> <span class="math inline">\(\mathtt{qplot}\)</span></a></li>
<li class="chapter" data-level="5.3.2" data-path="05-plots.html"><a href="05-plots.html#layered-graphics-using-mathttggplot"><i class="fa fa-check"></i><b>5.3.2</b> Layered graphics using <span class="math inline">\(\mathtt{ggplot}\)</span></a></li>
<li class="chapter" data-level="5.3.3" data-path="05-plots.html"><a href="05-plots.html#arranging-plots-using-gridextra"><i class="fa fa-check"></i><b>5.3.3</b> Arranging plots using gridExtra</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html"><i class="fa fa-check"></i><b>6</b> Graphics in R (Part-II)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html#interactive-plots-using-plotly"><i class="fa fa-check"></i><b>6.1</b> Interactive Plots using Plotly</a></li>
<li class="chapter" data-level="6.2" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html#animation-using-gganimate"><i class="fa fa-check"></i><b>6.2</b> Animation using gganimate</a></li>
<li class="chapter" data-level="6.3" data-path="06-plotsRmd.html"><a href="06-plotsRmd.html#plot-maps"><i class="fa fa-check"></i><b>6.3</b> Plot Maps</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="062-regression_1.html"><a href="062-regression_1.html"><i class="fa fa-check"></i>Part II</a></li>
<li class="chapter" data-level="7" data-path="062-regression_1.html"><a href="062-regression_1.html#linear-regression"><i class="fa fa-check"></i><b>7</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="062-regression_1.html"><a href="062-regression_1.html#investment-beta-using-r-single-index-model"><i class="fa fa-check"></i><b>7.1</b> Investment <span class="math inline">\(\beta\)</span> using R (Single Index Model)</a></li>
<li class="chapter" data-level="7.2" data-path="062-regression_1.html"><a href="062-regression_1.html#data-preprocessing-1"><i class="fa fa-check"></i><b>7.2</b> Data preprocessing</a></li>
<li class="chapter" data-level="7.3" data-path="062-regression_1.html"><a href="062-regression_1.html#visualisation"><i class="fa fa-check"></i><b>7.3</b> Visualisation</a></li>
<li class="chapter" data-level="7.4" data-path="062-regression_1.html"><a href="062-regression_1.html#regression-analysis-using-lm"><i class="fa fa-check"></i><b>7.4</b> Regression analysis using lm</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="062-regression_1.html"><a href="062-regression_1.html#multiple-regression"><i class="fa fa-check"></i><b>8</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="062-regression_1.html"><a href="062-regression_1.html#fama-french-three-factor-model"><i class="fa fa-check"></i><b>8.1</b> Fama-French Three Factor Model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="062-regression_1.html"><a href="062-regression_1.html#data-preprocessing-2"><i class="fa fa-check"></i><b>8.1.1</b> Data Preprocessing</a></li>
<li class="chapter" data-level="8.1.2" data-path="062-regression_1.html"><a href="062-regression_1.html#regression-analysis"><i class="fa fa-check"></i><b>8.1.2</b> Regression Analysis</a></li>
<li class="chapter" data-level="8.1.3" data-path="062-regression_1.html"><a href="062-regression_1.html#visualisation-1"><i class="fa fa-check"></i><b>8.1.3</b> Visualisation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="062-regression_1.html"><a href="062-regression_1.html#panel-regression"><i class="fa fa-check"></i><b>9</b> Panel Regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="062-regression_1.html"><a href="062-regression_1.html#fixed-and-random-effects-using-the-plm-package"><i class="fa fa-check"></i><b>9.1</b> Fixed and Random effects using the <code>plm</code> package</a></li>
<li class="chapter" data-level="9.2" data-path="062-regression_1.html"><a href="062-regression_1.html#fixed-effects-model"><i class="fa fa-check"></i><b>9.2</b> Fixed Effects Model</a></li>
<li class="chapter" data-level="9.3" data-path="062-regression_1.html"><a href="062-regression_1.html#random-effects-model"><i class="fa fa-check"></i><b>9.3</b> Random Effects Model</a></li>
<li class="chapter" data-level="9.4" data-path="062-regression_1.html"><a href="062-regression_1.html#testing"><i class="fa fa-check"></i><b>9.4</b> Testing</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="062-regression_1.html"><a href="062-regression_1.html#panel-or-ols"><i class="fa fa-check"></i><b>9.4.1</b> Panel or OLS</a></li>
<li class="chapter" data-level="9.4.2" data-path="062-regression_1.html"><a href="062-regression_1.html#fixed-effect-or-random-effect"><i class="fa fa-check"></i><b>9.4.2</b> Fixed Effect or Random Effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="01-Part_1.html"><a href="01-Part_1.html"><i class="fa fa-check"></i><b>10</b> Technical Analysis using R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="01-Part_1.html"><a href="01-Part_1.html#technical-analysis-ta-using-r"><i class="fa fa-check"></i><b>10.1</b> Technical Analysis (TA) using R</a></li>
<li class="chapter" data-level="10.2" data-path="01-Part_1.html"><a href="01-Part_1.html#technical-charts"><i class="fa fa-check"></i><b>10.2</b> Technical Charts</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="01-Part_1.html"><a href="01-Part_1.html#candlesticks-and-ohlc-chart"><i class="fa fa-check"></i><b>10.2.1</b> Candlesticks and OHLC chart</a></li>
<li class="chapter" data-level="10.2.2" data-path="01-Part_1.html"><a href="01-Part_1.html#line-chart"><i class="fa fa-check"></i><b>10.2.2</b> Line chart</a></li>
<li class="chapter" data-level="10.2.3" data-path="01-Part_1.html"><a href="01-Part_1.html#candlestick-chart"><i class="fa fa-check"></i><b>10.2.3</b> Candlestick chart</a></li>
<li class="chapter" data-level="10.2.4" data-path="01-Part_1.html"><a href="01-Part_1.html#add-technical-indicators"><i class="fa fa-check"></i><b>10.2.4</b> Add technical indicators</a></li>
<li class="chapter" data-level="10.2.5" data-path="01-Part_1.html"><a href="01-Part_1.html#adding-indicators-sequentially"><i class="fa fa-check"></i><b>10.2.5</b> Adding indicators sequentially</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="01-Part_1.html"><a href="01-Part_1.html#forecasting-var-using-garch-models"><i class="fa fa-check"></i><b>11</b> Forecasting VaR using GARCH Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="01-Part_1.html"><a href="01-Part_1.html#value-at-risk"><i class="fa fa-check"></i><b>11.1</b> Value at Risk</a></li>
<li class="chapter" data-level="11.2" data-path="01-Part_1.html"><a href="01-Part_1.html#volatility-modelling-forecasting-using-garch"><i class="fa fa-check"></i><b>11.2</b> Volatility Modelling &amp; Forecasting using GARCH</a></li>
<li class="chapter" data-level="11.3" data-path="01-Part_1.html"><a href="01-Part_1.html#garch11-to-forecast-var"><i class="fa fa-check"></i><b>11.3</b> GARCH(1,1) to forecast VaR</a></li>
<li class="chapter" data-level="11.4" data-path="01-Part_1.html"><a href="01-Part_1.html#var-forecasts-using-out-of-sample"><i class="fa fa-check"></i><b>11.4</b> VaR forecasts using out of sample</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html"><i class="fa fa-check"></i><b>12</b> Portfolio Modelling using R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-analysis-quick-intro"><i class="fa fa-check"></i><b>12.1</b> Portfolio Analysis (Quick Intro)</a></li>
<li class="chapter" data-level="12.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#mean-variance-portfolio-important-concepts"><i class="fa fa-check"></i><b>12.2</b> Mean Variance Portfolio: Important concepts</a>
<ul>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#expected-return"><i class="fa fa-check"></i>Expected Return</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#risk"><i class="fa fa-check"></i>Risk</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#covariance-of-returns"><i class="fa fa-check"></i>Covariance of Returns</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#correlation"><i class="fa fa-check"></i>Correlation</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-return"><i class="fa fa-check"></i>Portfolio Return</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-risk"><i class="fa fa-check"></i>Portfolio Risk</a></li>
<li class="chapter" data-level="" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-risk-for-n-assets"><i class="fa fa-check"></i>Portfolio Risk for <em>N</em> Assets</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#diversification-markowitz-minimum-variance-portfolio"><i class="fa fa-check"></i><b>12.3</b> Diversification &amp; Markowitz Minimum Variance Portfolio</a></li>
<li class="chapter" data-level="12.4" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#minimum-variance-portfolio"><i class="fa fa-check"></i><b>12.4</b> Minimum Variance Portfolio</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#efficient-weights-for-two-assets"><i class="fa fa-check"></i><b>12.4.1</b> Efficient Weights for Two Assets</a></li>
<li class="chapter" data-level="12.4.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-with-n-risky-assets"><i class="fa fa-check"></i><b>12.4.2</b> Portfolio with N Risky Assets</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#using-r-to-construct-multi-asset-portfolio"><i class="fa fa-check"></i><b>12.5</b> Using R to Construct Multi-Asset Portfolio</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#data"><i class="fa fa-check"></i><b>12.5.1</b> Data</a></li>
<li class="chapter" data-level="12.5.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolios-with-random-weights"><i class="fa fa-check"></i><b>12.5.2</b> Portfolios with random weights</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#efficient-minimum-variance-portfolio-using-r-packages"><i class="fa fa-check"></i><b>12.6</b> Efficient (Minimum Variance) Portfolio using R packages</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#minimum-variance-and-portfolio-for-a-given-level-of-return"><i class="fa fa-check"></i><b>12.6.1</b> Minimum Variance and portfolio for a given level of return</a></li>
<li class="chapter" data-level="12.6.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#portfolio-with-box-constraints"><i class="fa fa-check"></i><b>12.6.2</b> Portfolio with Box Constraints</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#evaluating-portfoios-risk-adjusted-performance"><i class="fa fa-check"></i><b>12.7</b> Evaluating Portfoios: Risk Adjusted Performance</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#sharpe-ratio"><i class="fa fa-check"></i><b>12.7.1</b> Sharpe Ratio</a></li>
<li class="chapter" data-level="12.7.2" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#roys-safety-ratio"><i class="fa fa-check"></i><b>12.7.2</b> Roy’s Safety Ratio</a></li>
<li class="chapter" data-level="12.7.3" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#treynors-ratio"><i class="fa fa-check"></i><b>12.7.3</b> Treynor’s Ratio</a></li>
<li class="chapter" data-level="12.7.4" data-path="01-Part_2_portfolio.html"><a href="01-Part_2_portfolio.html#sharpe-ratio-portfolio-in-r"><i class="fa fa-check"></i><b>12.7.4</b> Sharpe Ratio (Portfolio) in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html"><i class="fa fa-check"></i>Part III</a></li>
<li class="chapter" data-level="13" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#machine-learning-using-r-introduction-to-data-splitting-sampling-resampling"><i class="fa fa-check"></i><b>13</b> Machine Learning using R-Introduction to Data Splitting, Sampling &amp; Resampling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#machine-learning-process-quick-intro"><i class="fa fa-check"></i><b>13.1</b> Machine Learning Process (Quick Intro)</a></li>
<li class="chapter" data-level="13.2" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#data-splitting-sampling"><i class="fa fa-check"></i><b>13.2</b> Data Splitting: Sampling</a></li>
<li class="chapter" data-level="13.3" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#random-sampling"><i class="fa fa-check"></i><b>13.3</b> Random Sampling</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#base-r"><i class="fa fa-check"></i><b>13.3.1</b> Base R</a></li>
<li class="chapter" data-level="13.3.2" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#using-the-caret-package"><i class="fa fa-check"></i><b>13.3.2</b> Using the <code>caret</code> package</a></li>
<li class="chapter" data-level="13.3.3" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#using-the-rsample-package"><i class="fa fa-check"></i><b>13.3.3</b> Using the <code>rsample</code> package</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#stratified-sampling"><i class="fa fa-check"></i><b>13.4</b> Stratified Sampling</a></li>
<li class="chapter" data-level="13.5" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#resampling"><i class="fa fa-check"></i><b>13.5</b> Resampling</a></li>
<li class="chapter" data-level="13.6" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>13.6</b> K-fold Cross Validation</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#k-fold-cv-in-r"><i class="fa fa-check"></i>K-fold CV in R</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#cv-for-time-series-data"><i class="fa fa-check"></i><b>13.7</b> CV for time series data</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#cv-for-time-series-in-r"><i class="fa fa-check"></i>CV for time series in R</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#bootstrapping"><i class="fa fa-check"></i><b>13.8</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3-1.html"><a href="04-Part_3-1.html#bootsrapping-in-r"><i class="fa fa-check"></i>Bootsrapping in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html"><i class="fa fa-check"></i><b>14</b> Logistic Regression &amp; K-Nearest Neighbour (kNN) for Classification</a>
<ul>
<li class="chapter" data-level="14.1" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#logistic-regression"><i class="fa fa-check"></i><b>14.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="14.2" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#k-nearest-neighbour"><i class="fa fa-check"></i><b>14.2</b> K-Nearest Neighbour</a>
<ul>
<li class="chapter" data-level="" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#nearest-neighbour-classification-quick-introduction"><i class="fa fa-check"></i>Nearest Neighbour classification (Quick Introduction)</a></li>
<li class="chapter" data-level="" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#k-nn-algorithm"><i class="fa fa-check"></i>k-NN Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#forecasting-stock-price-movement-using-ml"><i class="fa fa-check"></i><b>14.3</b> Forecasting Stock Price Movement using ML</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#data-indicators"><i class="fa fa-check"></i><b>14.3.1</b> Data &amp; Indicators</a></li>
<li class="chapter" data-level="14.3.2" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#visualise-the-data"><i class="fa fa-check"></i><b>14.3.2</b> Visualise the data</a></li>
<li class="chapter" data-level="14.3.3" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#using-logistic-regression"><i class="fa fa-check"></i><b>14.3.3</b> Using Logistic Regression</a></li>
<li class="chapter" data-level="14.3.4" data-path="04-Part_3_logistic.html"><a href="04-Part_3_logistic.html#using-k-nn"><i class="fa fa-check"></i><b>14.3.4</b> Using K-NN</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="04-Part_2.html"><a href="04-Part_2.html"><i class="fa fa-check"></i><b>15</b> Decision Trees using R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="04-Part_2.html"><a href="04-Part_2.html#import-data-and-pre-processing"><i class="fa fa-check"></i><b>15.1</b> Import Data and Pre-processing</a></li>
<li class="chapter" data-level="15.2" data-path="04-Part_2.html"><a href="04-Part_2.html#visualisation-some-features"><i class="fa fa-check"></i><b>15.2</b> Visualisation some features</a></li>
<li class="chapter" data-level="15.3" data-path="04-Part_2.html"><a href="04-Part_2.html#creating-training-and-testing-set-and-control"><i class="fa fa-check"></i><b>15.3</b> Creating Training and Testing Set and Control</a></li>
<li class="chapter" data-level="15.4" data-path="04-Part_2.html"><a href="04-Part_2.html#train-the-model-on-the-training-set"><i class="fa fa-check"></i><b>15.4</b> Train the model on the training set</a></li>
<li class="chapter" data-level="15.5" data-path="04-Part_2.html"><a href="04-Part_2.html#prediction-and-accuracy"><i class="fa fa-check"></i><b>15.5</b> Prediction and Accuracy</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="04-Part_2.html"><a href="04-Part_2.html#model-1"><i class="fa fa-check"></i><b>15.5.1</b> Model-1</a></li>
<li class="chapter" data-level="15.5.2" data-path="04-Part_2.html"><a href="04-Part_2.html#model-2"><i class="fa fa-check"></i><b>15.5.2</b> Model-2</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="04-Part_2.html"><a href="04-Part_2.html#feature-interpretation"><i class="fa fa-check"></i><b>15.6</b> Feature Interpretation</a></li>
<li class="chapter" data-level="15.7" data-path="04-Part_2.html"><a href="04-Part_2.html#tree-visualisation"><i class="fa fa-check"></i><b>15.7</b> Tree visualisation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="05-method2.html"><a href="05-method2.html"><i class="fa fa-check"></i><b>16</b> Text Mining using R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="05-method2.html"><a href="05-method2.html#introduction-to-text-mining"><i class="fa fa-check"></i><b>16.1</b> Introduction to Text Mining</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="05-method2.html"><a href="05-method2.html#text-data"><i class="fa fa-check"></i><b>16.1.1</b> Text Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="05-method2.html"><a href="05-method2.html#generic-text-mining-system"><i class="fa fa-check"></i><b>16.1.2</b> Generic Text Mining System</a></li>
<li class="chapter" data-level="16.1.3" data-path="05-method2.html"><a href="05-method2.html#data-pre-processing-in-text-mining"><i class="fa fa-check"></i><b>16.1.3</b> Data pre-processing in Text Mining</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="05-method2.html"><a href="05-method2.html#mining-twitter-text-data-using-r"><i class="fa fa-check"></i><b>16.2</b> Mining Twitter Text Data using R</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="05-method2.html"><a href="05-method2.html#obtaining-twitter-data"><i class="fa fa-check"></i><b>16.2.1</b> Obtaining Twitter Data</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="05-method2.html"><a href="05-method2.html#download-data"><i class="fa fa-check"></i><b>16.3</b> Download Data</a></li>
<li class="chapter" data-level="16.4" data-path="05-method2.html"><a href="05-method2.html#data-pre-processing"><i class="fa fa-check"></i><b>16.4</b> Data Pre-processing</a></li>
<li class="chapter" data-level="16.5" data-path="05-method2.html"><a href="05-method2.html#some-visualisation"><i class="fa fa-check"></i><b>16.5</b> Some Visualisation</a></li>
<li class="chapter" data-level="16.6" data-path="05-method2.html"><a href="05-method2.html#sentiment-analysis"><i class="fa fa-check"></i><b>16.6</b> Sentiment Analysis</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="05-method2.html"><a href="05-method2.html#method"><i class="fa fa-check"></i><b>16.6.1</b> Method</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="05-method2.html"><a href="05-method2.html#topic-modelling"><i class="fa fa-check"></i><b>16.7</b> Topic Modelling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="06-method3.html"><a href="06-method3.html"><i class="fa fa-check"></i>Part IV</a></li>
<li class="chapter" data-level="17" data-path="06-method3.html"><a href="06-method3.html#bibliometrix-analysis-using-r"><i class="fa fa-check"></i><b>17</b> Bibliometrix Analysis using R</a>
<ul>
<li class="chapter" data-level="17.1" data-path="06-method3.html"><a href="06-method3.html#introduction-to-bibliometric-analysis"><i class="fa fa-check"></i><b>17.1</b> Introduction to Bibliometric Analysis</a></li>
<li class="chapter" data-level="17.2" data-path="06-method3.html"><a href="06-method3.html#r-and-bibliometric-analysis"><i class="fa fa-check"></i><b>17.2</b> R and Bibliometric analysis</a></li>
<li class="chapter" data-level="17.3" data-path="06-method3.html"><a href="06-method3.html#bibliometrix-example"><i class="fa fa-check"></i><b>17.3</b> Bibliometrix Example</a></li>
<li class="chapter" data-level="17.4" data-path="06-method3.html"><a href="06-method3.html#descriptive-analysis"><i class="fa fa-check"></i><b>17.4</b> Descriptive Analysis</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="06-method3.html"><a href="06-method3.html#productive-authors"><i class="fa fa-check"></i><b>17.4.1</b> Productive Authors</a></li>
<li class="chapter" data-level="17.4.2" data-path="06-method3.html"><a href="06-method3.html#most-cited-papers"><i class="fa fa-check"></i><b>17.4.2</b> Most cited papers</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="06-method3.html"><a href="06-method3.html#information-plots"><i class="fa fa-check"></i><b>17.5</b> Information Plots</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="06-method3.html"><a href="06-method3.html#summary-plot-1-most-porductive-authors"><i class="fa fa-check"></i><b>17.5.1</b> Summary Plot-1 (Most Porductive Authors)</a></li>
<li class="chapter" data-level="17.5.2" data-path="06-method3.html"><a href="06-method3.html#summary-plot-2-most-productive-countries"><i class="fa fa-check"></i><b>17.5.2</b> Summary Plot-2 (Most Productive Countries)</a></li>
<li class="chapter" data-level="17.5.3" data-path="06-method3.html"><a href="06-method3.html#summary-plot-3-annual-scientific-production"><i class="fa fa-check"></i><b>17.5.3</b> Summary Plot-3 (Annual Scientific Production)</a></li>
<li class="chapter" data-level="17.5.4" data-path="06-method3.html"><a href="06-method3.html#summary-plot-4-average-article-citation"><i class="fa fa-check"></i><b>17.5.4</b> Summary Plot-4 (Average Article Citation)</a></li>
<li class="chapter" data-level="17.5.5" data-path="06-method3.html"><a href="06-method3.html#summary-plot-5-author-production-over-time"><i class="fa fa-check"></i><b>17.5.5</b> Summary Plot-5 (Author Production Over Time)</a></li>
<li class="chapter" data-level="17.5.6" data-path="06-method3.html"><a href="06-method3.html#sankey-plot"><i class="fa fa-check"></i><b>17.5.6</b> Sankey plot</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="06-method3.html"><a href="06-method3.html#co-word-analysis"><i class="fa fa-check"></i><b>17.6</b> Co-word Analysis</a></li>
<li class="chapter" data-level="17.7" data-path="06-method3.html"><a href="06-method3.html#author-collaboration-network"><i class="fa fa-check"></i><b>17.7</b> Author collaboration network</a></li>
<li class="chapter" data-level="17.8" data-path="06-method3.html"><a href="06-method3.html#keyword-co-occurance"><i class="fa fa-check"></i><b>17.8</b> Keyword co-occurance</a></li>
<li class="chapter" data-level="17.9" data-path="06-method3.html"><a href="06-method3.html#thematic-map"><i class="fa fa-check"></i><b>17.9</b> Thematic Map</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="06-summary.html"><a href="06-summary.html"><i class="fa fa-check"></i><b>18</b> Work in Progress</a></li>
<li class="chapter" data-level="" data-path="07-references.html"><a href="07-references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><img src="firebrick3RA_img.png" height="60" width="60" style="position:bottom:0px;right:0px;"/></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression-k-nearest-neighbour-knn-for-classification" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Topic 14</span> Logistic Regression &amp; K-Nearest Neighbour (kNN) for Classification<a href="04-Part_3_logistic.html#logistic-regression-k-nearest-neighbour-knn-for-classification" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="rforda.png" height="100" width="100" style="position:absolute;top:0px;right:0px;"/></p>
<p>This topic provides a brief introduction to two ML methods used for classification; Logistic Regression and K-Nearest Neighbour. The topic includes an example on predicting the direction of stock price movement to illustrate the application of R for these two models.</p>
<div id="logistic-regression" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Logistic Regression<a href="04-Part_3_logistic.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Logistic Regression belongs to the class of generalised linear models (glms)generalised linear models (glms)</p></li>
<li><p>Used to model data with a dichotomous response variable.</p></li>
<li><p>Logistic regression models the conditional probability of the response variable rather than its value.</p></li>
<li><p>A logit link function, defined as <span class="math inline">\(logit\,p=log[p/(1-p)]\)</span>, is used to transform the output of a linear regression to be suitable for probabilities.</p></li>
<li><p>A linear model for these transformed probabilities can be setup as</p></li>
</ul>
<span class="math display" id="eq:glm1">\[\begin{equation}

logit\,p=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\ldots\beta_{k}x_{x}
\tag{14.1}

\end{equation}\]</span>
<ul>
<li>R provides the <code>glm</code> function for modelling generalised linear models including the logistic regression model</li>
<li>We will use the caret package to model logistic regression later in this topic.</li>
<li>See <span class="citation">Hastie et al. (<a href="#ref-Hastie2013" role="doc-biblioref">2013</a>)</span> and <span class="citation">Boehmke &amp; Greenwell (<a href="#ref-Boehmke2019" role="doc-biblioref">2019</a>)</span> for further details on logistic regression.</li>
</ul>
</div>
<div id="k-nearest-neighbour" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> K-Nearest Neighbour<a href="04-Part_3_logistic.html#k-nearest-neighbour" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="nearest-neighbour-classification-quick-introduction" class="section level3 unnumbered hasAnchor">
<h3>Nearest Neighbour classification (Quick Introduction)<a href="04-Part_3_logistic.html#nearest-neighbour-classification-quick-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Idea: Things that are alike are likely to have similar properties.</p></li>
<li><p>ML uses this principle to classify data by placing it in the same category or similar, or “nearest” neighbours.</p></li>
<li><p>Computers apply a human like ability to recall past experiences to make conclusions about current circumstances.</p></li>
<li><p>Nearest neighbour methods are based on a simple idea, yet they can be extremely powerful.</p></li>
<li><p>In general, well suited for classification tasks.</p></li>
<li><p>If a concept is difficult to define, but you know it when you see it, then nearest neighbours might be appropriate.</p></li>
<li><p>If the data is noisy and thus no clear distinction exists among the groups, nearest neighbour algorithms may struggle to identify the class boundaries.</p></li>
</ul>
</div>
<div id="k-nn-algorithm" class="section level3 unnumbered hasAnchor">
<h3>k-NN Algorithm<a href="04-Part_3_logistic.html#k-nn-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>K-nearest neighbor (KNN) is a very simple algorithm in which each observation is predicted based on its “similarity” to other observations.</p></li>
<li><p>The letter k is a variable term implying that any number of nearest neighbors could be used.</p></li>
<li><p>After choosing k, the algorithm requires a training dataset made up of examples that have been classified into several categories, as labeled by a nominal variable</p></li>
<li><p>Unlike most methods in ML, KNN is a memory-based algorithm and cannot be summarized by a closed-form model.</p></li>
</ul>
<p><strong>Measuring similarity in distance</strong></p>
<ul>
<li><p>Locating the nearest neighbours require a distance function; measuring similarity between two instances</p></li>
<li><p>k-NN uses Euclidean distance, a distance between two points. Euclidean distance is measured as the shortest direct route.</p></li>
<li><p>For p and q instances (to be compared) with n features</p></li>
</ul>
<span class="math display" id="eq:knn1">\[\begin{equation}
dist(p,q)=\sqrt{(p_{1}-q_{1})^{2}+(p_{2}-q_{2})^{2}+\ldots+(p_{n}-q_{n})^{2}}
\tag{14.2}

\end{equation}\]</span>
<p><strong>Choosing k</strong></p>
<ul>
<li><p>The balance between overfitting and underfitting the training data is a problem known as the bias-variance tradeoff.</p></li>
<li><p>Choosing a large k reduces the impact or variance caused by noisy data but can bias the learner such that it runs the risk of ignoring small, but important patterns.</p></li>
<li><p>There is no general rule about the best k as it depends greatly on the nature of the data.</p></li>
<li><p>A grid search can be performed to assess the best value of k</p></li>
<li><p>Grid Search: A grid search is an automated approach to searching across many combinations of hyperparameter values.</p>
<ul>
<li>A grid search would predefine a candidate set of values for k (e.g., k=1,2,…,j ) and perform a resampling method (e.g., k-fold CV) to estimate which k value generalizes the best to unseen data.</li>
</ul></li>
<li><p>The caret package can be used to implement the knn method.</p></li>
</ul>
<blockquote>
<p>The next section demonstrate an application of Logistic Regression and KNN using an example from the applied finance domain.</p>
</blockquote>
</div>
</div>
<div id="forecasting-stock-price-movement-using-ml" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Forecasting Stock Price Movement using ML<a href="04-Part_3_logistic.html#forecasting-stock-price-movement-using-ml" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Topic-7 provided an introduction to using R for creating Technical Indicators for traded assets. This example uses selected indicators to predict the direction of the price movement, i.e., if the prices will be higher or lower the next day. Various studies have evaluated ML methods to predict the price direction or return, for example, <span class="citation">Shynkevich, McGinnity, Coleman, Belatreche, &amp; Li (<a href="#ref-Shynkevich2017" role="doc-biblioref">2017</a>)</span> examined indicators like SMA, EMA etc on various forecast horizons and window lengths.</p>
<ul>
<li><p>The example will use the closing prices of a stock (BHP in this case) to create the following Technical Indicators</p></li>
<li><p>Lag of 5 Days Simple Moving Average : Moving averages are the simplest among all indicators: they show the average price level for you on a rolling basis.</p></li>
<li><p>Lag 5 Days Exponential Moving Average: The difference between SMA and EMA is that SMA weighs all candles equally whereas EMA gives exponential weights – hence the name: it overweights recent days to previous ones.</p></li>
<li><p>MACD: Moving Average Convergence Divergence: Uses EMA of 26 and 12 days. Designed to reveal changes in strength, direction, momentum and duration of a trend in stock price.</p></li>
<li><p>Lag of Log Returns</p></li>
<li><p>Lag of RSI: Momentum oscillator that measures the speed and change of price movements. Ranges from zero to 100. Can be used to identify general trends.</p></li>
<li><p>The response (dependent) variable is constructed based on the previous day(s) prices. Here we use the following indicator:</p></li>
</ul>
<span class="math display" id="eq:ind1">\[\begin{equation}

1 \rightarrow P_{t}\geq P_{t-5}\\
0\, otherswise
\tag{14.3}

\end{equation}\]</span>
<div id="data-indicators" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Data &amp; Indicators<a href="04-Part_3_logistic.html#data-indicators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="04-Part_3_logistic.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb355-2"><a href="04-Part_3_logistic.html#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TTR)</span>
<span id="cb355-3"><a href="04-Part_3_logistic.html#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)  <span class="co">#required as the data was saved as an xts object</span></span>
<span id="cb355-4"><a href="04-Part_3_logistic.html#cb355-4" aria-hidden="true" tabindex="-1"></a>d_bhp <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">&quot;data/bhp_prices.rds&quot;</span>)</span>
<span id="cb355-5"><a href="04-Part_3_logistic.html#cb355-5" aria-hidden="true" tabindex="-1"></a>d_bhp <span class="ot">=</span> d_bhp<span class="sc">$</span>BHP.AX.Close  <span class="co">#select close prices</span></span>
<span id="cb355-6"><a href="04-Part_3_logistic.html#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(d_bhp) <span class="ot">=</span> <span class="st">&quot;Price&quot;</span></span>
<span id="cb355-7"><a href="04-Part_3_logistic.html#cb355-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-8"><a href="04-Part_3_logistic.html#cb355-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-9"><a href="04-Part_3_logistic.html#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SMA</span></span>
<span id="cb355-10"><a href="04-Part_3_logistic.html#cb355-10" aria-hidden="true" tabindex="-1"></a>sma5 <span class="ot">=</span> <span class="fu">lag</span>(<span class="fu">SMA</span>(d_bhp, <span class="at">n =</span> <span class="dv">5</span>))  <span class="co">#notice the use of the lag function to take lagged values</span></span>
<span id="cb355-11"><a href="04-Part_3_logistic.html#cb355-11" aria-hidden="true" tabindex="-1"></a><span class="co"># EMA</span></span>
<span id="cb355-12"><a href="04-Part_3_logistic.html#cb355-12" aria-hidden="true" tabindex="-1"></a>ema5 <span class="ot">=</span> <span class="fu">lag</span>(<span class="fu">EMA</span>(d_bhp, <span class="at">n =</span> <span class="dv">5</span>))</span>
<span id="cb355-13"><a href="04-Part_3_logistic.html#cb355-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MACD</span></span>
<span id="cb355-14"><a href="04-Part_3_logistic.html#cb355-14" aria-hidden="true" tabindex="-1"></a>macd1 <span class="ot">=</span> <span class="fu">lag</span>(<span class="fu">MACD</span>(d_bhp))</span>
<span id="cb355-15"><a href="04-Part_3_logistic.html#cb355-15" aria-hidden="true" tabindex="-1"></a><span class="co"># RSI</span></span>
<span id="cb355-16"><a href="04-Part_3_logistic.html#cb355-16" aria-hidden="true" tabindex="-1"></a>rsi1 <span class="ot">=</span> <span class="fu">lag</span>(<span class="fu">RSI</span>(d_bhp, <span class="dv">5</span>))</span>
<span id="cb355-17"><a href="04-Part_3_logistic.html#cb355-17" aria-hidden="true" tabindex="-1"></a><span class="co"># log returns</span></span>
<span id="cb355-18"><a href="04-Part_3_logistic.html#cb355-18" aria-hidden="true" tabindex="-1"></a>ret1 <span class="ot">=</span> <span class="fu">lag</span>(<span class="fu">dailyReturn</span>(d_bhp, <span class="at">type =</span> <span class="st">&quot;log&quot;</span>))</span>
<span id="cb355-19"><a href="04-Part_3_logistic.html#cb355-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-20"><a href="04-Part_3_logistic.html#cb355-20" aria-hidden="true" tabindex="-1"></a><span class="co"># price director indicator</span></span>
<span id="cb355-21"><a href="04-Part_3_logistic.html#cb355-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-22"><a href="04-Part_3_logistic.html#cb355-22" aria-hidden="true" tabindex="-1"></a>dir <span class="ot">=</span> <span class="fu">ifelse</span>(d_bhp<span class="sc">$</span>Price <span class="sc">&gt;=</span> <span class="fu">lag</span>(d_bhp<span class="sc">$</span>Price, <span class="dv">5</span>), <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co">#direction variable compared to  5 day before price</span></span></code></pre></div>
<ul>
<li>Combine all the indicators and response variable in a data frame</li>
</ul>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="04-Part_3_logistic.html#cb356-1" aria-hidden="true" tabindex="-1"></a>d_ex1 <span class="ot">=</span> <span class="fu">cbind</span>(dir, ret1, sma5, ema5, macd1, rsi1)</span>
<span id="cb356-2"><a href="04-Part_3_logistic.html#cb356-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-3"><a href="04-Part_3_logistic.html#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="co"># change column names</span></span>
<span id="cb356-4"><a href="04-Part_3_logistic.html#cb356-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(d_ex1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Direction&quot;</span>, <span class="st">&quot;Ret&quot;</span>, <span class="st">&quot;SMA&quot;</span>, <span class="st">&quot;EMA&quot;</span>, <span class="st">&quot;MACD&quot;</span>, <span class="st">&quot;Signal&quot;</span>,</span>
<span id="cb356-5"><a href="04-Part_3_logistic.html#cb356-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;RSI&quot;</span>)</span></code></pre></div>
</div>
<div id="visualise-the-data" class="section level3 hasAnchor" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> Visualise the data<a href="04-Part_3_logistic.html#visualise-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Using the quantmod package</li>
</ul>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="04-Part_3_logistic.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chartSeries</span>(d_bhp, <span class="at">theme =</span> <span class="st">&quot;white&quot;</span>, <span class="at">name =</span> <span class="st">&quot;BHP Closing Prices and Indicators&quot;</span>)</span>
<span id="cb357-2"><a href="04-Part_3_logistic.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">addTA</span>(d_ex1[, <span class="dv">1</span>], <span class="at">col =</span> <span class="dv">1</span>, <span class="at">legend =</span> <span class="st">&quot;Direction&quot;</span>)  <span class="co">#Direction</span></span>
<span id="cb357-3"><a href="04-Part_3_logistic.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="fu">addTA</span>(d_ex1[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">on =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">6</span>), <span class="at">legend =</span> <span class="fu">as.character</span>(<span class="fu">colnames</span>(d_ex1[,</span>
<span id="cb357-4"><a href="04-Part_3_logistic.html#cb357-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span>])))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex1f1"></span>
<img src="R_for_Analytics_files/figure-html/ex1f1-1.png" alt="Direction and Technical Indicators" width="672" />
<p class="caption">
Figure 14.1: Direction and Technical Indicators
</p>
</div>
<ul>
<li>The above graph can be improved using ggplot2</li>
</ul>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="04-Part_3_logistic.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb358-2"><a href="04-Part_3_logistic.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb358-3"><a href="04-Part_3_logistic.html#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a dataset and convert data to long</span></span>
<span id="cb358-4"><a href="04-Part_3_logistic.html#cb358-4" aria-hidden="true" tabindex="-1"></a>d_plot <span class="ot">=</span> <span class="fu">merge.xts</span>(d_bhp, d_ex1)</span>
<span id="cb358-5"><a href="04-Part_3_logistic.html#cb358-5" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NAs and then convert to long</span></span>
<span id="cb358-6"><a href="04-Part_3_logistic.html#cb358-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-7"><a href="04-Part_3_logistic.html#cb358-7" aria-hidden="true" tabindex="-1"></a>d_plot <span class="ot">=</span> <span class="fu">na.omit</span>(d_plot)</span>
<span id="cb358-8"><a href="04-Part_3_logistic.html#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to dataframe</span></span>
<span id="cb358-9"><a href="04-Part_3_logistic.html#cb358-9" aria-hidden="true" tabindex="-1"></a>d_plot <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> <span class="fu">index</span>(d_plot), <span class="fu">coredata</span>(d_plot))</span>
<span id="cb358-10"><a href="04-Part_3_logistic.html#cb358-10" aria-hidden="true" tabindex="-1"></a>d_plot_long <span class="ot">=</span> <span class="fu">pivot_longer</span>(d_plot, <span class="sc">-</span><span class="fu">c</span>(Date, Direction), <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>,</span>
<span id="cb358-11"><a href="04-Part_3_logistic.html#cb358-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;Indicator&quot;</span>)</span>
<span id="cb358-12"><a href="04-Part_3_logistic.html#cb358-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-13"><a href="04-Part_3_logistic.html#cb358-13" aria-hidden="true" tabindex="-1"></a><span class="co"># change direction to a factor</span></span>
<span id="cb358-14"><a href="04-Part_3_logistic.html#cb358-14" aria-hidden="true" tabindex="-1"></a>d_plot_long<span class="sc">$</span>Direction <span class="ot">=</span> <span class="fu">as.factor</span>(d_plot_long<span class="sc">$</span>Direction)</span>
<span id="cb358-15"><a href="04-Part_3_logistic.html#cb358-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-16"><a href="04-Part_3_logistic.html#cb358-16" aria-hidden="true" tabindex="-1"></a>(<span class="at">p2_ex =</span> <span class="fu">ggplot</span>(d_plot_long, <span class="fu">aes</span>(Date, value, <span class="at">color =</span> Indicator)) <span class="sc">+</span> <span class="fu">geom_path</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb358-17"><a href="04-Part_3_logistic.html#cb358-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(Indicator <span class="sc">~</span> ., <span class="at">scale =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>())</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex1f2"></span>
<img src="R_for_Analytics_files/figure-html/ex1f2-1.png" alt="Indicators and Prices (ggplot2)" width="672" />
<p class="caption">
Figure 14.2: Indicators and Prices (ggplot2)
</p>
</div>
<ul>
<li>The above is a line chart of indicators and prices. We can also create a box plot to visualise the variance in the values relative to the direction</li>
</ul>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="04-Part_3_logistic.html#cb359-1" aria-hidden="true" tabindex="-1"></a>p2_ex <span class="ot">=</span> <span class="fu">ggplot</span>(d_plot_long, <span class="fu">aes</span>(value, Indicator, <span class="at">fill =</span> Direction)) <span class="sc">+</span></span>
<span id="cb359-2"><a href="04-Part_3_logistic.html#cb359-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>()</span>
<span id="cb359-3"><a href="04-Part_3_logistic.html#cb359-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-4"><a href="04-Part_3_logistic.html#cb359-4" aria-hidden="true" tabindex="-1"></a>p2_ex <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;TA Indicators vs Price Direction&quot;</span>) <span class="sc">+</span></span>
<span id="cb359-5"><a href="04-Part_3_logistic.html#cb359-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;Price Direction&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;lightblue&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex1f3"></span>
<img src="R_for_Analytics_files/figure-html/ex1f3-1.png" alt="Box Plot of Indicators" width="672" />
<p class="caption">
Figure 14.3: Box Plot of Indicators
</p>
</div>
<ul>
<li>Some differences per category can be noticed</li>
</ul>
</div>
<div id="using-logistic-regression" class="section level3 hasAnchor" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> Using Logistic Regression<a href="04-Part_3_logistic.html#using-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>70:30 data split</li>
<li>Time series sampling
<ul>
<li>Stratified sampling will not keep the time order and hence its avoided</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="04-Part_3_logistic.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NAs</span></span>
<span id="cb360-2"><a href="04-Part_3_logistic.html#cb360-2" aria-hidden="true" tabindex="-1"></a>d_ex1 <span class="ot">=</span> <span class="fu">na.omit</span>(d_ex1)</span>
<span id="cb360-3"><a href="04-Part_3_logistic.html#cb360-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to data frame</span></span>
<span id="cb360-4"><a href="04-Part_3_logistic.html#cb360-4" aria-hidden="true" tabindex="-1"></a>d_ex1 <span class="ot">=</span> <span class="fu">as.data.frame</span>(d_ex1)</span>
<span id="cb360-5"><a href="04-Part_3_logistic.html#cb360-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert direction to a factor for classification</span></span>
<span id="cb360-6"><a href="04-Part_3_logistic.html#cb360-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-7"><a href="04-Part_3_logistic.html#cb360-7" aria-hidden="true" tabindex="-1"></a>d_ex1<span class="sc">$</span>Direction <span class="ot">=</span> <span class="fu">as.factor</span>(d_ex1<span class="sc">$</span>Direction)</span>
<span id="cb360-8"><a href="04-Part_3_logistic.html#cb360-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-9"><a href="04-Part_3_logistic.html#cb360-9" aria-hidden="true" tabindex="-1"></a>idx1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">nrow</span>(d_ex1) <span class="sc">*</span> <span class="fl">0.7</span>))  <span class="co">#create index for first 70% values to be in the testing set</span></span>
<span id="cb360-10"><a href="04-Part_3_logistic.html#cb360-10" aria-hidden="true" tabindex="-1"></a>d_train1 <span class="ot">=</span> d_ex1[idx1, ]  <span class="co">#training set</span></span>
<span id="cb360-11"><a href="04-Part_3_logistic.html#cb360-11" aria-hidden="true" tabindex="-1"></a>d_test1 <span class="ot">=</span> d_ex1[<span class="sc">-</span>idx1, ]  <span class="co">#testing set</span></span></code></pre></div>
<p><strong>Training Setup</strong></p>
<ul>
<li>Time series cross validate for resampling: 250 day window 30 days for prediction (this can be changed)</li>
<li>Data preprocessing is conducted to normalise the scale of the values</li>
<li><code>glm</code> method with binomial family for the binary classification</li>
</ul>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="04-Part_3_logistic.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb361-2"><a href="04-Part_3_logistic.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb361-3"><a href="04-Part_3_logistic.html#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co"># control</span></span>
<span id="cb361-4"><a href="04-Part_3_logistic.html#cb361-4" aria-hidden="true" tabindex="-1"></a>cntrl1 <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;timeslice&quot;</span>, <span class="at">initialWindow =</span> <span class="dv">250</span>, <span class="at">horizon =</span> <span class="dv">30</span>,</span>
<span id="cb361-5"><a href="04-Part_3_logistic.html#cb361-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixedWindow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb361-6"><a href="04-Part_3_logistic.html#cb361-6" aria-hidden="true" tabindex="-1"></a><span class="co"># preprocesing</span></span>
<span id="cb361-7"><a href="04-Part_3_logistic.html#cb361-7" aria-hidden="true" tabindex="-1"></a>prep1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;scale&quot;</span>)</span>
<span id="cb361-8"><a href="04-Part_3_logistic.html#cb361-8" aria-hidden="true" tabindex="-1"></a><span class="co"># logistic regression</span></span>
<span id="cb361-9"><a href="04-Part_3_logistic.html#cb361-9" aria-hidden="true" tabindex="-1"></a>logit_ex1 <span class="ot">=</span> <span class="fu">train</span>(Direction <span class="sc">~</span> ., <span class="at">data =</span> d_train1, <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb361-10"><a href="04-Part_3_logistic.html#cb361-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> cntrl1, <span class="at">preProcess =</span> prep1)</span>
<span id="cb361-11"><a href="04-Part_3_logistic.html#cb361-11" aria-hidden="true" tabindex="-1"></a>logit_ex1  <span class="co">#final model accuracy</span></span></code></pre></div>
<pre><code>Generalized Linear Model 

434 samples
  6 predictor
  2 classes: &#39;0&#39;, &#39;1&#39; 

Pre-processing: centered (6), scaled (6) 
Resampling: Rolling Forecasting Origin Resampling (30 held-out with a fixed window) 
Summary of sample sizes: 250, 250, 250, 250, 250, 250, ... 
Resampling results:

  Accuracy   Kappa    
  0.7324731  0.4658076</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="04-Part_3_logistic.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_ex1<span class="sc">$</span>finalModel)  <span class="co">#summary of the final model</span></span></code></pre></div>
<pre><code>
Call:
NULL

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.43299  -0.63007  -0.04745   0.57603   2.49565  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -0.05772    0.13429  -0.430    0.667    
Ret          -0.82494    0.18720  -4.407 1.05e-05 ***
SMA         -20.20397    3.70217  -5.457 4.83e-08 ***
EMA          20.05707    3.67374   5.460 4.77e-08 ***
MACD          0.50610    0.73203   0.691    0.489    
Signal       -0.94914    0.68541  -1.385    0.166    
RSI           2.14092    0.30037   7.128 1.02e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 601.61  on 433  degrees of freedom
Residual deviance: 348.17  on 427  degrees of freedom
AIC: 362.17

Number of Fisher Scoring iterations: 5</code></pre>
<ul>
<li>Variable importance</li>
<li>In the case of multiple predictor variables, we want to understand which variable is the most influential in predicting the response variable.</li>
</ul>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="04-Part_3_logistic.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb365-2"><a href="04-Part_3_logistic.html#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(logit_ex1, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex1f4"></span>
<img src="R_for_Analytics_files/figure-html/ex1f4-1.png" alt="Variable Importance" width="672" />
<p class="caption">
Figure 14.4: Variable Importance
</p>
</div>
<p><strong>Predictive Accuracy</strong></p>
<ul>
<li>ML models should be checked for predictive accuracy on the test set</li>
<li>caret provides <code>predict</code> function to create predictions</li>
<li>These predictions can be assessed based on the confusion matrix</li>
</ul>
<p><strong>Confusion Matrix</strong>
- When applying classification models, we often use a confusion matrix to evaluate certain performance measures.</p>
<ul>
<li><p>A confusion matrix is simply a matrix that compares actual categorical levels (or events) to the predicted categorical levels.</p></li>
<li><p>Prediction of the right level; refer to this as a true positive.</p></li>
<li><p>Prediction of a level or event that did not happen this is called a false positive (i.e. we predicted a customer would redeem a coupon and they did not).</p></li>
<li><p>Alternatively, when we do not predict a level or event and it does happen that this is called a false negative (i.e. a customer that we did not predict to redeem a coupon does).</p></li>
<li><p>Let’s predict using the final model and assess using the confusion matrix.</p></li>
</ul>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="04-Part_3_logistic.html#cb366-1" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">=</span> <span class="fu">predict</span>(logit_ex1, <span class="at">newdata =</span> d_test1)  <span class="co">#prediction on the test data</span></span>
<span id="cb366-2"><a href="04-Part_3_logistic.html#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> pred1, <span class="at">reference =</span> d_test1<span class="sc">$</span>Direction)</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 52 26
         1 16 92
                                          
               Accuracy : 0.7742          
                 95% CI : (0.7073, 0.8321)
    No Information Rate : 0.6344          
    P-Value [Acc &gt; NIR] : 2.959e-05       
                                          
                  Kappa : 0.5279          
                                          
 Mcnemar&#39;s Test P-Value : 0.1649          
                                          
            Sensitivity : 0.7647          
            Specificity : 0.7797          
         Pos Pred Value : 0.6667          
         Neg Pred Value : 0.8519          
             Prevalence : 0.3656          
         Detection Rate : 0.2796          
   Detection Prevalence : 0.4194          
      Balanced Accuracy : 0.7722          
                                          
       &#39;Positive&#39; Class : 0               
                                          </code></pre>
<ul>
<li>The model provides decent accuracy which is higher than the No Information Rate and also statistically significant.</li>
</ul>
<p>There are other analyses which can be conducted on logistic regression, for example, ROC (Receiver Operating Characteristic) curve analysis for the Area Under the Curve.</p>
</div>
<div id="using-k-nn" class="section level3 hasAnchor" number="14.3.4">
<h3><span class="header-section-number">14.3.4</span> Using K-NN<a href="04-Part_3_logistic.html#using-k-nn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>This section will implement the previous model using k-nearest neigbour algorithm using the caret package</li>
<li>Then we will use the same split as the logistic regression</li>
<li>We are selecting the model based on Accuracy &amp; Kappa</li>
<li>Accuracy: Accuracy measures the overall correctness of the classifier <span class="math inline">\(\frac{(TN+TP)}{Total}\)</span>. Objective: maximise</li>
<li>Kappa (Cohen’s Kappa): Its like Accuracy but it is normalised at the baseline of random chance on the dataset. It compares observed accuracy to expected accuracy.</li>
<li>A grid search is used to search for an optimal value for k</li>
</ul>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="04-Part_3_logistic.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb368-2"><a href="04-Part_3_logistic.html#cb368-2" aria-hidden="true" tabindex="-1"></a>grid1 <span class="ot">=</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>))  <span class="co">#to search from k=1 to k=10 </span></span>
<span id="cb368-3"><a href="04-Part_3_logistic.html#cb368-3" aria-hidden="true" tabindex="-1"></a>knn_ex1 <span class="ot">=</span> <span class="fu">train</span>(Direction <span class="sc">~</span> ., <span class="at">data =</span> d_train1, <span class="at">method =</span> <span class="st">&quot;knn&quot;</span>, <span class="at">tuneGrid =</span> grid1,</span>
<span id="cb368-4"><a href="04-Part_3_logistic.html#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> cntrl1, <span class="at">preProcess =</span> prep1)</span></code></pre></div>
<ul>
<li>View the fit</li>
</ul>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="04-Part_3_logistic.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knn_ex1)  <span class="co">#may suggest using a wider grid</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex1f5"></span>
<img src="R_for_Analytics_files/figure-html/ex1f5-1.png" alt="Grid plot" width="672" />
<p class="caption">
Figure 14.5: Grid plot
</p>
</div>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="04-Part_3_logistic.html#cb370-1" aria-hidden="true" tabindex="-1"></a>knn_ex1</span></code></pre></div>
<pre><code>k-Nearest Neighbors 

434 samples
  6 predictor
  2 classes: &#39;0&#39;, &#39;1&#39; 

Pre-processing: centered (6), scaled (6) 
Resampling: Rolling Forecasting Origin Resampling (30 held-out with a fixed window) 
Summary of sample sizes: 250, 250, 250, 250, 250, 250, ... 
Resampling results across tuning parameters:

  k  Accuracy   Kappa    
  1  0.5898925  0.1554741
  3  0.6066667  0.1834679
  5  0.6419355  0.2500894
  7  0.6690323  0.3194890
  9  0.6686022  0.3209926

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was k = 7.</code></pre>
<p><em>Variable importance can’t be obtained here as KNN does not produce a model</em></p>
<p><strong>Predictive Accuracy</strong></p>
<p>Let’s predict using the final model and assess using the confusion matrix.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="04-Part_3_logistic.html#cb372-1" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">=</span> <span class="fu">predict</span>(knn_ex1, <span class="at">newdata =</span> d_test1)  <span class="co">#prediction on the test data</span></span>
<span id="cb372-2"><a href="04-Part_3_logistic.html#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> pred2, <span class="at">reference =</span> d_test1<span class="sc">$</span>Direction)</span></code></pre></div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  0  1
         0 50 50
         1 18 68
                                          
               Accuracy : 0.6344          
                 95% CI : (0.5608, 0.7037)
    No Information Rate : 0.6344          
    P-Value [Acc &gt; NIR] : 0.5330295       
                                          
                  Kappa : 0.2833          
                                          
 Mcnemar&#39;s Test P-Value : 0.0001704       
                                          
            Sensitivity : 0.7353          
            Specificity : 0.5763          
         Pos Pred Value : 0.5000          
         Neg Pred Value : 0.7907          
             Prevalence : 0.3656          
         Detection Rate : 0.2688          
   Detection Prevalence : 0.5376          
      Balanced Accuracy : 0.6558          
                                          
       &#39;Positive&#39; Class : 0               
                                          </code></pre>
<ul>
<li><p>A comparison betweek Logistic Regression and KNN can be made based on their predictive accuracy.</p></li>
<li><p>The two models can also be compared based on their resampling results.</p></li>
<li><p>The random number seeds should be initialised to the same value for resampling comparison.</p></li>
<li><p>The following code compares the model fits.</p></li>
</ul>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="04-Part_3_logistic.html#cb374-1" aria-hidden="true" tabindex="-1"></a>resamp1 <span class="ot">=</span> <span class="fu">resamples</span>(<span class="fu">list</span>(<span class="at">logit =</span> logit_ex1, <span class="at">knn =</span> knn_ex1))</span>
<span id="cb374-2"><a href="04-Part_3_logistic.html#cb374-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-3"><a href="04-Part_3_logistic.html#cb374-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resamp1)</span></code></pre></div>
<pre><code>
Call:
summary.resamples(object = resamp1)

Models: logit, knn 
Number of resamples: 155 

Accuracy 
           Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA&#39;s
logit 0.4666667 0.6666667 0.7333333 0.7324731 0.8000000 0.9000000    0
knn   0.4333333 0.5666667 0.6666667 0.6690323 0.7666667 0.8666667    0

Kappa 
            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA&#39;s
logit  0.1208791 0.3333333 0.4666667 0.4658076 0.5838144 0.7887324    0
knn   -0.1860465 0.1558442 0.3243243 0.3194890 0.4666667 0.7235023    0</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="04-Part_3_logistic.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(resamp1, <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex1f6"></span>
<img src="R_for_Analytics_files/figure-html/ex1f6-1.png" alt="Resample Accuracy comparison" width="672" />
<p class="caption">
Figure 14.6: Resample Accuracy comparison
</p>
</div>
<ul>
<li>The graph provides a comparison of the overall accuracy of the model (not the predictions).</li>
</ul>

</div>
</div>
</div>
<h3>References<a href="07-references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Boehmke2019" class="csl-entry">
Boehmke, B., &amp; Greenwell, B. M. (2019). <em>Hands-on machine learning with r</em>. CRC Press. Retrieved from <a href="https://bradleyboehmke.github.io/HOML/">https://bradleyboehmke.github.io/HOML/</a>
</div>
<div id="ref-Hastie2013" class="csl-entry">
Hastie, T., Tibshirani, R., James, G., &amp; Witten, D. (2013). <em>An introduction to statistical learning with applications in r</em>. Springer New York.
</div>
<div id="ref-Shynkevich2017" class="csl-entry">
Shynkevich, Y., McGinnity, T. M., Coleman, S. A., Belatreche, A., &amp; Li, Y. (2017). Forecasting price movements using technical indicators: Investigating the impact of varying input window length. <em>Neurocomputing</em>, <em>264</em>, 71–88. https://doi.org/<a href="https://doi.org/10.1016/j.neucom.2016.11.095">https://doi.org/10.1016/j.neucom.2016.11.095</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="04-Part_3-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="04-Part_2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
