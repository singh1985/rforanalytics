<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Value at Risk | R for Data Analytics</title>
  <meta name="description" content="This is a collection of examples on using R for Data Analytics" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Value at Risk | R for Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a collection of examples on using R for Data Analytics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Value at Risk | R for Data Analytics" />
  
  <meta name="twitter:description" content="This is a collection of examples on using R for Data Analytics" />
  

<meta name="author" content="Abhay Singh" />


<meta name="date" content="2020-09-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="rforda.png" type="image/x-icon" />
<link rel="prev" href="3-forecasting-var-using-garch-models.html"/>
<link rel="next" href="3-2-volatility-modelling-forecasting-using-garch.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Data Analytics: Use Cases</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-technical-analysis-using-r.html"><a href="1-technical-analysis-using-r.html"><i class="fa fa-check"></i><b>1</b> Technical Analysis using R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-1-technical-analysis-ta-using-r.html"><a href="1-1-technical-analysis-ta-using-r.html"><i class="fa fa-check"></i><b>1.1</b> Technical Analysis (TA) using R</a></li>
<li class="chapter" data-level="1.2" data-path="1-2-technical-charts.html"><a href="1-2-technical-charts.html"><i class="fa fa-check"></i><b>1.2</b> Technical Charts</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-2-technical-charts.html"><a href="1-2-technical-charts.html#candlesticks-and-ohlc-chart"><i class="fa fa-check"></i><b>1.2.1</b> Candlesticks and OHLC chart</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-2-technical-charts.html"><a href="1-2-technical-charts.html#line-chart"><i class="fa fa-check"></i><b>1.2.2</b> Line chart</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-2-technical-charts.html"><a href="1-2-technical-charts.html#candlestick-chart"><i class="fa fa-check"></i><b>1.2.3</b> Candlestick chart</a></li>
<li class="chapter" data-level="1.2.4" data-path="1-2-technical-charts.html"><a href="1-2-technical-charts.html#add-technical-indicators"><i class="fa fa-check"></i><b>1.2.4</b> Add technical indicators</a></li>
<li class="chapter" data-level="1.2.5" data-path="1-2-technical-charts.html"><a href="1-2-technical-charts.html#adding-indicators-sequentially"><i class="fa fa-check"></i><b>1.2.5</b> Adding indicators sequentially</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-linear-regression.html"><a href="2-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-1-investment-beta-using-r-single-index-model.html"><a href="2-1-investment-beta-using-r-single-index-model.html"><i class="fa fa-check"></i><b>2.1</b> Investment <span class="math inline">\(\beta\)</span> using R (Single Index Model)</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-data-preprocessing.html"><a href="2-2-data-preprocessing.html"><i class="fa fa-check"></i><b>2.2</b> Data preprocessing</a></li>
<li class="chapter" data-level="2.3" data-path="2-3-visualisation.html"><a href="2-3-visualisation.html"><i class="fa fa-check"></i><b>2.3</b> Visualisation</a></li>
<li class="chapter" data-level="2.4" data-path="2-4-regression-analysis-using-lm.html"><a href="2-4-regression-analysis-using-lm.html"><i class="fa fa-check"></i><b>2.4</b> Regression analysis using lm</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-forecasting-var-using-garch-models.html"><a href="3-forecasting-var-using-garch-models.html"><i class="fa fa-check"></i><b>3</b> Forecasting VaR using GARCH Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-1-value-at-risk.html"><a href="3-1-value-at-risk.html"><i class="fa fa-check"></i><b>3.1</b> Value at Risk</a></li>
<li class="chapter" data-level="3.2" data-path="3-2-volatility-modelling-forecasting-using-garch.html"><a href="3-2-volatility-modelling-forecasting-using-garch.html"><i class="fa fa-check"></i><b>3.2</b> Volatility Modelling &amp; Forecasting using GARCH</a></li>
<li class="chapter" data-level="3.3" data-path="3-3-garch11-to-forecast-var.html"><a href="3-3-garch11-to-forecast-var.html"><i class="fa fa-check"></i><b>3.3</b> GARCH(1,1) to forecast VaR</a></li>
<li class="chapter" data-level="3.4" data-path="3-4-var-forecasts-using-out-of-sample.html"><a href="3-4-var-forecasts-using-out-of-sample.html"><i class="fa fa-check"></i><b>3.4</b> VaR forecasts using out of sample</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-decision-trees-using-r.html"><a href="4-decision-trees-using-r.html"><i class="fa fa-check"></i><b>4</b> Decision Trees using R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-1-import-data-and-pre-processing.html"><a href="4-1-import-data-and-pre-processing.html"><i class="fa fa-check"></i><b>4.1</b> Import Data and Pre-processing</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-visualisation-some-features.html"><a href="4-2-visualisation-some-features.html"><i class="fa fa-check"></i><b>4.2</b> Visualisation some features</a></li>
<li class="chapter" data-level="4.3" data-path="4-3-creating-training-and-testing-set-and-control.html"><a href="4-3-creating-training-and-testing-set-and-control.html"><i class="fa fa-check"></i><b>4.3</b> Creating Training and Testing Set and Control</a></li>
<li class="chapter" data-level="4.4" data-path="4-4-train-the-model-on-the-training-set.html"><a href="4-4-train-the-model-on-the-training-set.html"><i class="fa fa-check"></i><b>4.4</b> Train the model on the training set</a></li>
<li class="chapter" data-level="4.5" data-path="4-5-prediction-and-accuracy.html"><a href="4-5-prediction-and-accuracy.html"><i class="fa fa-check"></i><b>4.5</b> Prediction and Accuracy</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="4-5-prediction-and-accuracy.html"><a href="4-5-prediction-and-accuracy.html#model-1"><i class="fa fa-check"></i><b>4.5.1</b> Model-1</a></li>
<li class="chapter" data-level="4.5.2" data-path="4-5-prediction-and-accuracy.html"><a href="4-5-prediction-and-accuracy.html#model-2"><i class="fa fa-check"></i><b>4.5.2</b> Model-2</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="4-6-feature-interpretation.html"><a href="4-6-feature-interpretation.html"><i class="fa fa-check"></i><b>4.6</b> Feature Interpretation</a></li>
<li class="chapter" data-level="4.7" data-path="4-7-tree-visualisation.html"><a href="4-7-tree-visualisation.html"><i class="fa fa-check"></i><b>4.7</b> Tree visualisation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-text-mining-using-r.html"><a href="5-text-mining-using-r.html"><i class="fa fa-check"></i><b>5</b> Text Mining using R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-1-introduction-to-text-mining.html"><a href="5-1-introduction-to-text-mining.html"><i class="fa fa-check"></i><b>5.1</b> Introduction to Text Mining</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-1-introduction-to-text-mining.html"><a href="5-1-introduction-to-text-mining.html#text-data"><i class="fa fa-check"></i><b>5.1.1</b> Text Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-1-introduction-to-text-mining.html"><a href="5-1-introduction-to-text-mining.html#generic-text-mining-system"><i class="fa fa-check"></i><b>5.1.2</b> Generic Text Mining System</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-1-introduction-to-text-mining.html"><a href="5-1-introduction-to-text-mining.html#data-pre-processing-in-text-mining"><i class="fa fa-check"></i><b>5.1.3</b> Data pre-processing in Text Mining</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-2-mining-twitter-text-data-using-r.html"><a href="5-2-mining-twitter-text-data-using-r.html"><i class="fa fa-check"></i><b>5.2</b> Mining Twitter Text Data using R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-2-mining-twitter-text-data-using-r.html"><a href="5-2-mining-twitter-text-data-using-r.html#obtaining-twitter-data"><i class="fa fa-check"></i><b>5.2.1</b> Obtaining Twitter Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-3-download-data.html"><a href="5-3-download-data.html"><i class="fa fa-check"></i><b>5.3</b> Download Data</a></li>
<li class="chapter" data-level="5.4" data-path="5-4-data-pre-processing.html"><a href="5-4-data-pre-processing.html"><i class="fa fa-check"></i><b>5.4</b> Data Pre-processing</a></li>
<li class="chapter" data-level="5.5" data-path="5-5-some-visualisation.html"><a href="5-5-some-visualisation.html"><i class="fa fa-check"></i><b>5.5</b> Some Visualisation</a></li>
<li class="chapter" data-level="5.6" data-path="5-6-sentiment-analysis.html"><a href="5-6-sentiment-analysis.html"><i class="fa fa-check"></i><b>5.6</b> Sentiment Analysis</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="5-6-sentiment-analysis.html"><a href="5-6-sentiment-analysis.html#method"><i class="fa fa-check"></i><b>5.6.1</b> Method</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="5-7-topic-modelling.html"><a href="5-7-topic-modelling.html"><i class="fa fa-check"></i><b>5.7</b> Topic Modelling</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-work-in-progress.html"><a href="6-work-in-progress.html"><i class="fa fa-check"></i><b>6</b> Work in Progress</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li> <img src="firebrick3RA_img.png" height="60" width="60" style="position:bottom:0px;right:0px;"/></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="value-at-risk" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Value at Risk</h2>
<ul>
<li>Value at Risk (VaR) is the most widely used market risk measure in financial risk management and it is also used by practitioners such as portfolio managers to account for future market risk. VaR can be defined as loss in market value of an asset over a given time period that is exceeded with a probability <span class="math inline">\(\theta\)</span>. For a time series of returns <span class="math inline">\(r_{t}\)</span> , <span class="math inline">\(VaR_{t}\)</span> would be such that</li>
</ul>
<p><span class="math display" id="eq:var">\[\begin{equation}

P[r_{t}&lt;-VaR_{t}[I_{t-1}]=\theta
 
\tag{3.1}

\end{equation}\]</span></p>
<p>where <span class="math inline">\(I_{t-1}\)</span> represents the information set at time t-1.</p>
<ul>
<li>Despite the appealing simplicity of VaR in its offering of a simple summary of the downside risk of an asset portfolio, there is no single way to calculate it (see ?? (<span class="citation">(<span class="citeproc-not-found" data-reference-id="Manganelli2001"><strong>???</strong></span>)</span>) for an overview on VaR methods in finance).</li>
</ul>
<p>1% VaR</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="3-1-value-at-risk.html#cb23-1"></a><span class="co"># calculate normal density</span></span>
<span id="cb23-2"><a href="3-1-value-at-risk.html#cb23-2"></a></span>
<span id="cb23-3"><a href="3-1-value-at-risk.html#cb23-3"></a>den1_r =<span class="st"> </span>data_lm1<span class="op">$</span>bhp</span>
<span id="cb23-4"><a href="3-1-value-at-risk.html#cb23-4"></a>den1_bhp =<span class="st"> </span><span class="kw">dnorm</span>(<span class="dt">x =</span> den1_r, <span class="dt">mean =</span> <span class="kw">mean</span>(den1_r), <span class="dt">sd =</span> <span class="kw">sd</span>(den1_r))</span>
<span id="cb23-5"><a href="3-1-value-at-risk.html#cb23-5"></a>data_rd =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> den1_r, <span class="dt">y =</span> den1_bhp)</span>
<span id="cb23-6"><a href="3-1-value-at-risk.html#cb23-6"></a><span class="co"># normal quantile</span></span>
<span id="cb23-7"><a href="3-1-value-at-risk.html#cb23-7"></a>var1 =<span class="st"> </span><span class="kw">quantile</span>(den1_r, <span class="fl">0.01</span>)</span>
<span id="cb23-8"><a href="3-1-value-at-risk.html#cb23-8"></a>p3 =<span class="st"> </span><span class="kw">ggplot</span>(data_rd, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> var1, </span>
<span id="cb23-9"><a href="3-1-value-at-risk.html#cb23-9"></a>    <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Distribution and 1% (Empirical) VaR&quot;</span>)</span>
<span id="cb23-10"><a href="3-1-value-at-risk.html#cb23-10"></a>p3</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-13"></span>
<img src="01-Part_1_files/figure-html/unnamed-chunk-13-1.png" alt="1% VaR" width="672" />
<p class="caption">
Figure 3.1: 1% VaR
</p>
</div>
<ul>
<li>In distribution terms, for a distribution F, VaR can be defined as its p-th quantile given by</li>
</ul>
<p><span class="math display" id="eq:var1">\[\begin{equation}

VaR_{p}(V_{p})=F^{-1}(1-p)
 
\tag{3.2}

\end{equation}\]</span></p>
<p>where <span class="math inline">\(F^{-1}\)</span> is the inverse of the distribution function also called as the quantile function. Hence VaR is easy to calculate once a distribution for the return series can be defined.</p>
<ul>
<li>VaR is the q-th quantile of the distribution of over a time horizon t, which is a well accepted measure of risk in financial management.</li>
</ul>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3-forecasting-var-using-garch-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3-2-volatility-modelling-forecasting-using-garch.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
